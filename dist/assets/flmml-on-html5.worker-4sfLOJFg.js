/*! flmml-on-html5 v2.0.3 | (c) 2015, argentum384 (c) 2007, Takeshi OKUBO | BSD-3-Clause | https://github.com/argentum384/flmml-on-html5 */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var s=e();for(var i in s)("object"==typeof exports?exports:t)[i]=s[i]}}(self,(function(){return t={760:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.AudioExport=void 0,e.AudioExport=class{constructor(){this.bufferId=1}static crop(t){return t>1?1:t<-1?-1:t}onRequest(){this.onrequestbuffer({bufferId:this.bufferId})}beginRequest(t){t&&(this.onrequestbuffer=t),self.clearInterval(this.tID),this.tID=self.setInterval((()=>{this.onRequest()}),50)}request(t=null){this.beginRequest(),self.setTimeout((()=>{this.onrequestbuffer({retBuf:t,bufferId:this.bufferId})}),0)}}}.apply(e,[s,e]))||(t.exports=i)},814:(t,e,s)=>{var i,h;i=[s,e,s(587),s(581),s(760)],void 0===(h=function(t,e,s,i,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Mp3Export=void 0;class _ extends h.AudioExport{constructor(t=192){if(super(),!self.lamejs||!self.lamejs.Mp3Encoder)throw new i.FlMMLAudioExportError("lamejs is not imported");this.mp3Encoder=new lamejs.Mp3Encoder(2,s.SAMPLE_RATE,t),this.mp3Data=[]}process(t){const e=t.map((t=>{const e=new Int16Array(t.length);return t.forEach(((t,s)=>{e[s]=Math.floor(32767.5*h.AudioExport.crop(t))})),e})),s=this.mp3Encoder.encodeBuffer(e[0],e[1]);this.mp3Data.push(s.buffer),this.bufferId++}complete(){const t=this.mp3Encoder.flush();return t.length>0&&this.mp3Data.push(t.buffer),self.clearInterval(this.tID),this.mp3Data}}e.Mp3Export=_}.apply(e,i))||(t.exports=h)},95:(t,e,s)=>{var i,h;i=[s,e,s(587),s(760)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WavExport=void 0;const h=[82,73,70,70,0,0,0,0,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,0,0,0,0,0,0,0,0,4,0,16,0,100,97,116,97,0,0,0,0];class _ extends i.AudioExport{constructor(){super(),this.data=[],this.dataBytes=0}process(t){const e=new ArrayBuffer(4*t[0].length),s=new DataView(e);for(let e=0;e<t[0].length;e++)s.setInt16(4*e,Math.floor(32767.5*i.AudioExport.crop(t[0][e])),!0),s.setInt16(4*e+2,Math.floor(32767.5*i.AudioExport.crop(t[1][e])),!0);this.data.push(e),this.dataBytes+=e.byteLength,this.bufferId++}complete(){const t=new ArrayBuffer(h.length),e=new DataView(t);for(let t=0;t<h.length;t++)e.setUint8(t,h[t]);return e.setUint32(4,h.length+this.dataBytes-8,!0),e.setUint32(24,s.SAMPLE_RATE,!0),e.setUint32(28,4*s.SAMPLE_RATE,!0),e.setUint32(40,this.dataBytes,!0),self.clearInterval(this.tID),[t,...this.data]}}e.WavExport=_}.apply(e,i))||(t.exports=h)},587:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MsgTypes=e.SAMPLE_RATE=void 0,e.SAMPLE_RATE=44100,e.MsgTypes={BOOT:1,PLAY:2,STOP:3,PAUSE:4,COMPCOMP:6,BUFRING:7,COMPLETE:8,SYNCINFO:9,PLAYSOUND:10,STOPSOUND:11,EXPORT:12}}.apply(e,[s,e]))||(t.exports=i)},581:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlMMLAudioExportError=void 0;class s extends Error{constructor(...t){super(...t),this.name="FlMMLAudioExportError"}}e.FlMMLAudioExportError=s}.apply(e,[s,e]))||(t.exports=i)},461:(t,e,s)=>{var i,h;i=[s,e,s(587),s(581),s(95),s(814),s(565)],void 0===(h=function(t,e,s,i,h,_,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.FlMMLWorker=void 0;class a{constructor(){this.onInfoTimerBinded=()=>{this.onInfoTimer()},addEventListener("message",(t=>{this.onMessage(t)}))}onMessage(t){const e=t.data,a=e.type,o=this.mml;switch(a){case s.MsgTypes.BOOT:this.bufferSize=e.bufferSize,this.bufferMultiple=e.bufferMultiple,this.mml=new r.MML(this),e.lamejsURL&&self.importScripts(e.lamejsURL);break;case s.MsgTypes.PLAY:if(!o)break;o.play(e.mml),this.audioExport&&this.completeAudioExport();break;case s.MsgTypes.STOP:if(!o)break;o.stop(),this.syncInfo(),this.audioExport&&this.completeAudioExport();break;case s.MsgTypes.PAUSE:if(!o)break;o.pause(),this.syncInfo();break;case s.MsgTypes.SYNCINFO:"number"==typeof e.interval?(this.infoInterval=e.interval,clearInterval(this.tIDInfo),this.infoInterval>0&&this.mml&&this.mml.isPlaying()&&(this.tIDInfo=self.setInterval(this.onInfoTimerBinded,this.infoInterval))):this.syncInfo();break;case s.MsgTypes.PLAYSOUND:this.workletPort=e.workletPort,this.workletPort.onmessage=t=>{this.onrequestbuffer(t.data)};break;case s.MsgTypes.STOPSOUND:this.onstopsound&&this.onstopsound();break;case s.MsgTypes.EXPORT:if(!o){postMessage({type:s.MsgTypes.EXPORT,errorMsg:"Sequencer is not ready"});break}o.stop();try{switch(e.format){case"wav":this.audioExport=new h.WavExport;break;case"mp3":this.audioExport=new _.Mp3Export(e.bitrate)}}catch(t){if(t instanceof i.FlMMLAudioExportError)return void postMessage({type:s.MsgTypes.EXPORT,errorMsg:t.message});throw t}o.play(e.mml,!0),this.audioExport.beginRequest(this.onrequestbuffer)}}completeAudioExport(){const t=this.audioExport.complete();postMessage({type:s.MsgTypes.EXPORT,data:t},t),this.audioExport=null}buffering(t){postMessage({type:s.MsgTypes.BUFRING,progress:t})}compileComplete(){const t=this.mml;postMessage({type:s.MsgTypes.COMPCOMP,info:{totalMSec:t.getTotalMSec(),totalTimeStr:t.getTotalTimeStr(),warnings:t.getWarnings(),metaTitle:t.getMetaTitle(),metaComment:t.getMetaComment(),metaArtist:t.getMetaArtist(),metaCoding:t.getMetaCoding()}})}playSound(){postMessage({type:s.MsgTypes.PLAYSOUND}),this.syncInfo()}stopSound(){this.workletPort&&(this.workletPort.onmessage=null,this.workletPort.postMessage({release:!0})),postMessage({type:s.MsgTypes.STOPSOUND})}sendBuffer(t){this.audioExport?(this.audioExport.process(t),this.audioExport.request(t)):this.workletPort.postMessage({buffer:t},[t[0].buffer,t[1].buffer])}complete(){postMessage({type:s.MsgTypes.COMPLETE}),this.syncInfo(),this.audioExport&&this.completeAudioExport()}syncInfo(){const t=this.mml;t&&(this.lastInfoTime=self.performance?self.performance.now():(new Date).getTime(),postMessage({type:s.MsgTypes.SYNCINFO,info:{_isPlaying:t.isPlaying(),_isPaused:t.isPaused(),nowMSec:t.getNowMSec(),nowTimeStr:t.getNowTimeStr(),voiceCount:t.getVoiceCount()}}))}restartInfoTimer(){clearInterval(this.tIDInfo),this.tIDInfo=self.setInterval(this.onInfoTimerBinded,this.infoInterval)}onInfoTimer(){this.mml.isPlaying()?this.syncInfo():clearInterval(this.tIDInfo)}}e.FlMMLWorker=a,new a}.apply(e,i))||(t.exports=h)},870:(t,e,s)=>{var i,h;i=[s,e,s(587),s(721),s(208),s(795),s(630),s(777)],void 0===(h=function(t,e,s,i,h,_,r,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MChannel=void 0;class o{constructor(){this.m_noteNo=0,this.m_detune=0,this.m_freqNo=0,this.m_envelope1=new i.MEnvelope(0,60/127,30/127,1/127),this.m_envelope2=new i.MEnvelope(0,30/127,0,1),this.m_oscSet1=new a.MOscillator,this.m_oscMod1=this.m_oscSet1.getCurrent(),this.m_oscSet2=new a.MOscillator,this.m_oscSet2.asLFO(),this.m_oscSet2.setForm(a.MOscillator.SINE),this.m_oscMod2=this.m_oscSet2.getCurrent(),this.m_osc2Connect=0,this.m_filter=new h.MFilter,this.m_filterConnect=0,this.m_formant=new _.MFormant,this.m_volMode=0,this.setExpression(127),this.setVelocity(100),this.setPan(64),this.m_onCounter=0,this.m_lfoDelay=0,this.m_lfoDepth=0,this.m_lfoEnd=0,this.m_lpfAmt=0,this.m_lpfFrq=0,this.m_lpfRes=0,this.m_pulseWidth=.5,this.setInput(0,0),this.setOutput(0,0),this.setRing(0,0),this.setSync(0,0),this.m_portDepth=0,this.m_portDepthAdd=0,this.m_lastFreqNo=4800,this.m_portamento=0,this.m_portRate=0,this.m_voiceid=0,this.m_slaveVoice=!1}static boot(t){if(!this.s_init){var e;for(this.s_frequencyLen=this.s_frequencyMap.length,e=0;e<this.s_frequencyLen;e++)this.s_frequencyMap[e]=440*Math.pow(2,(e-69*this.PITCH_RESOLUTION)/(12*this.PITCH_RESOLUTION));for(this.s_volumeLen=128,this.s_volumeMap=new Array(3),e=0;e<3;e++)this.s_volumeMap[e]=new Array(this.s_volumeLen),this.s_volumeMap[e][0]=0;for(e=1;e<this.s_volumeLen;e++)this.s_volumeMap[0][e]=e/127,this.s_volumeMap[1][e]=Math.pow(10,48/2540*(e-127)),this.s_volumeMap[2][e]=Math.pow(10,96/2540*(e-127));this.s_init=1}this.s_samples=new Float32Array(t)}static createPipes(t){this.s_pipeArr=new Array(t);for(var e=0;e<t;e++)this.s_pipeArr[e]=new Float32Array(this.s_samples.length)}static createSyncSources(t){this.s_syncSources=new Array(t);for(var e=0;e<t;e++){this.s_syncSources[e]=new Array(this.s_samples.length);for(var s=0;s<this.s_samples.length;s++)this.s_syncSources[e][s]=!1}}static getFrequency(t){return t=(t|=0)<0?0:t>=o.s_frequencyLen?o.s_frequencyLen-1:t,o.s_frequencyMap[t]}setExpression(t){this.m_expression=o.s_volumeMap[this.m_volMode][t],this.m_ampLevel=this.m_velocity*this.m_expression,this.m_oscSet1.getMod(a.MOscillator.OPM).setExpression(this.m_expression)}setVelocity(t){this.m_velocity=o.s_volumeMap[this.m_volMode][t],this.m_ampLevel=this.m_velocity*this.m_expression,this.m_oscSet1.getMod(a.MOscillator.OPM).setVelocity(t)}setNoteNo(t,e=!0){this.m_noteNo=t,this.m_freqNo=this.m_noteNo*o.PITCH_RESOLUTION+this.m_detune,this.m_oscMod1.setFrequency(o.getFrequency(this.m_freqNo)),1===this.m_portamento&&(e?this.m_portDepth+=this.m_lastFreqNo-this.m_freqNo:this.m_portDepth=this.m_lastFreqNo-this.m_freqNo,this.m_portDepthAdd=this.m_portDepth<0?this.m_portRate:-1*this.m_portRate),this.m_lastFreqNo=this.m_freqNo}setDetune(t){this.m_detune=t,this.m_freqNo=this.m_noteNo*o.PITCH_RESOLUTION+this.m_detune,this.m_oscMod1.setFrequency(o.getFrequency(this.m_freqNo))}getNoteNo(){return this.m_noteNo}isPlaying(){return this.m_oscSet1.getForm()===a.MOscillator.OPM?this.m_oscSet1.getCurrent().IsPlaying():this.m_envelope1.isPlaying()}getId(){return this.m_voiceid}getVoiceCount(){return this.isPlaying()?1:0}setSlaveVoice(t){this.m_slaveVoice=t}noteOnWidthId(t,e,s){this.m_voiceid=s,this.noteOn(t,e)}noteOn(t,e){this.setNoteNo(t,!1),this.m_envelope1.triggerEnvelope(0),this.m_envelope2.triggerEnvelope(1),this.m_oscMod1.resetPhase(),this.m_oscMod2.resetPhase(),this.m_filter.reset(),this.setVelocity(e),this.m_onCounter=0,this.m_oscSet1.getMod(a.MOscillator.PULSE).setPWM(this.m_pulseWidth);var s=this.m_oscSet1;s.getMod(a.MOscillator.FC_NOISE).setNoteNo(this.m_noteNo),s.getMod(a.MOscillator.GB_NOISE).setNoteNo(this.m_noteNo),s.getMod(a.MOscillator.GB_S_NOISE).setNoteNo(this.m_noteNo),s.getMod(a.MOscillator.FC_DPCM).setNoteNo(this.m_noteNo),s.getMod(a.MOscillator.OPM).setNoteNo(this.m_noteNo)}noteOff(t){(t<0||t===this.m_noteNo)&&(this.m_envelope1.releaseEnvelope(),this.m_envelope2.releaseEnvelope(),this.m_oscSet1.getMod(a.MOscillator.OPM).noteOff())}setSoundOff(){this.m_envelope1.soundOff(),this.m_envelope2.soundOff()}close(){this.noteOff(this.m_noteNo),this.m_filter.setSwitch(0)}setNoiseFreq(t){this.m_oscSet1.getMod(a.MOscillator.NOISE).setNoiseFreq(1-t*(1/128))}setForm(t,e){this.m_oscMod1=this.m_oscSet1.setForm(t),this.m_oscMod1.setWaveNo(e)}setEnvelope1Atk(t){this.m_envelope1.setAttack(t*(1/127))}setEnvelope1Point(t,e){this.m_envelope1.addPoint(t*(1/127),e*(1/127))}setEnvelope1Rel(t){this.m_envelope1.setRelease(t*(1/127))}setEnvelope2Atk(t){this.m_envelope2.setAttack(t*(1/127))}setEnvelope2Point(t,e){this.m_envelope2.addPoint(t*(1/127),e*(1/127))}setEnvelope2Rel(t){this.m_envelope2.setRelease(t*(1/127))}setPWM(t){if(this.m_oscSet1.getForm()!==a.MOscillator.FC_PULSE){var e=this.m_oscSet1.getMod(a.MOscillator.PULSE);t<0?(e.setMIX(1),t*=-1):e.setMIX(0),this.m_pulseWidth=.01*t,e.setPWM(this.m_pulseWidth)}else t<0&&(t*=-1),this.m_oscSet1.getMod(a.MOscillator.FC_PULSE).setPWM(.125*Math.floor(t))}setPan(t){this.m_pan=.5/63*(t-1),this.m_pan<0&&(this.m_pan=0)}setFormant(t){t>=0?this.m_formant.setVowel(t):this.m_formant.disable()}setLFOFMSF(t,e){this.m_oscMod2=this.m_oscSet2.setForm(t>=0?t-1:-t-1),this.m_oscMod2.setWaveNo(e),this.m_osc2Sign=t>=0?1:-1,t<0&&(t=-t),--t>=a.MOscillator.MAX&&(this.m_osc2Connect=0)}setLFODPWD(t,e){this.m_lfoDepth=t,this.m_osc2Connect=0===t?0:1,this.m_oscMod2.setFrequency(e),this.m_oscMod2.resetPhase(),this.m_oscSet2.getMod(a.MOscillator.NOISE).setNoiseFreq(e/s.SAMPLE_RATE)}setLFODLTM(t,e){this.m_lfoDelay=t,this.m_lfoEnd=e>0?this.m_lfoDelay+e:0}setLFOTarget(t){this.m_lfoTarget=t}setLpfSwtAmt(t,e){-3<t&&t<3&&t!==this.m_filterConnect&&(this.m_filterConnect=t,this.m_filter.setSwitch(t)),this.m_lpfAmt=(e<-127?-127:e<127?e:127)*o.PITCH_RESOLUTION}setLpfFrqRes(t,e){t<0&&(t=0),t>127&&(t=127),this.m_lpfFrq=t*o.PITCH_RESOLUTION,this.m_lpfRes=e*(1/127),this.m_lpfRes<0&&(this.m_lpfRes=0),this.m_lpfRes>1&&(this.m_lpfRes=1)}setVolMode(t){switch(t){case 0:case 1:case 2:this.m_volMode=t}}setInput(t,e){this.m_inSens=1/8*(1<<t-1)*r.MOscMod.PHASE_LEN,this.m_inPipe=e}setOutput(t,e){this.m_outMode=t,this.m_outPipe=e}setRing(t,e){this.m_ringSens=(1<<t-1)/8,this.m_ringPipe=e}setSync(t,e){this.m_syncMode=t,this.m_syncPipe=e}setPortamento(t,e){this.m_portamento=0,this.m_portDepth=t,this.m_portDepthAdd=Math.floor(this.m_portDepth)/e*-1}setMidiPort(t){this.m_portamento=t,this.m_portDepth=0}setMidiPortRate(t){this.m_portRate=t}setPortBase(t){this.m_lastFreqNo=t}setVoiceLimit(t){}setHwLfo(t){var e=t>>27&3,s=t>>19&255,i=t>>12&127,h=t>>5&127,_=t>>2&7,r=t>>0&3,o=this.m_oscSet1.getMod(a.MOscillator.OPM);o.setWF(e),o.setLFRQ(s),o.setPMD(i),o.setAMD(h),o.setPMSAMS(_,r)}reset(){this.setSoundOff(),this.m_pulseWidth=.5,this.m_voiceid=0,this.setForm(0,0),this.setDetune(0),this.setExpression(127),this.setVelocity(100),this.setPan(64),this.setVolMode(0),this.setNoiseFreq(0),this.setLFOFMSF(0,0),this.m_osc2Connect=0,this.m_onCounter=0,this.m_lfoTarget=0,this.m_lfoDelay=0,this.m_lfoDepth=0,this.m_lfoEnd=0,this.setLpfSwtAmt(0,0),this.setLpfFrqRes(0,0),this.setFormant(-1),this.setInput(0,0),this.setOutput(0,0),this.setRing(0,0),this.setSync(0,0),this.m_portDepth=0,this.m_portDepthAdd=0,this.m_lastFreqNo=4800,this.m_portamento=0,this.m_portRate=0}clearOutPipe(t,e,s){1===this.m_outMode&&o.s_pipeArr[this.m_outPipe].fill(0,e,e+s)}getNextCutoff(){var t=this.m_lpfFrq+this.m_lpfAmt*this.m_envelope2.getNextAmplitudeLinear();return(t=o.getFrequency(t)*this.m_oscMod1.getFrequency()*(2*Math.PI/(440*s.SAMPLE_RATE)))<1/127&&(t=0),t}getSamples(t,e,s,i){var h,_,r,m,n,c,l,p,u,g,f,S,v=s+i,d=o.s_samples,M=this.isPlaying();v>=e&&(v=e);var E=o.getFrequency(this.m_freqNo);if(1===this.m_outMode&&!1===this.m_slaveVoice&&(d=o.s_pipeArr[this.m_outPipe]),M&&(0===this.m_portDepth?this.m_inSens>=1e-6?0===this.m_osc2Connect?this.getSamplesF__(d,s,v):0===this.m_lfoTarget?this.getSamplesFP_(d,s,v):3===this.m_lfoTarget?this.getSamplesFW_(d,s,v):4===this.m_lfoTarget?this.getSamplesFF_(d,s,v):this.getSamplesF__(d,s,v):2===this.m_syncMode?0===this.m_osc2Connect?this.getSamplesI__(d,s,v):0===this.m_lfoTarget?this.getSamplesIP_(d,s,v):3===this.m_lfoTarget?this.getSamplesIW_(d,s,v):this.getSamplesI__(d,s,v):1===this.m_syncMode?0===this.m_osc2Connect?this.getSamplesO__(d,s,v):0===this.m_lfoTarget?this.getSamplesOP_(d,s,v):3===this.m_lfoTarget?this.getSamplesOW_(d,s,v):this.getSamplesO__(d,s,v):0===this.m_osc2Connect?this.getSamples___(d,s,v):0===this.m_lfoTarget?this.getSamples_P_(d,s,v):3===this.m_lfoTarget?this.getSamples_W_(d,s,v):this.getSamples___(d,s,v):this.m_inSens>=1e-6?0===this.m_osc2Connect?this.getSamplesF_P(d,s,v):0===this.m_lfoTarget?this.getSamplesFPP(d,s,v):3===this.m_lfoTarget?this.getSamplesFWP(d,s,v):4===this.m_lfoTarget?this.getSamplesFFP(d,s,v):this.getSamplesF_P(d,s,v):2===this.m_syncMode?0===this.m_osc2Connect?this.getSamplesI_P(d,s,v):0===this.m_lfoTarget?this.getSamplesIPP(d,s,v):3===this.m_lfoTarget?this.getSamplesIWP(d,s,v):this.getSamplesI_P(d,s,v):1===this.m_syncMode?0===this.m_osc2Connect?this.getSamplesO_P(d,s,v):0===this.m_lfoTarget?this.getSamplesOPP(d,s,v):3===this.m_lfoTarget?this.getSamplesOWP(d,s,v):this.getSamplesO_P(d,s,v):0===this.m_osc2Connect?this.getSamples__P(d,s,v):0===this.m_lfoTarget?this.getSamples_PP(d,s,v):3===this.m_lfoTarget?this.getSamples_WP(d,s,v):this.getSamples__P(d,s,v)),this.m_oscSet1.getForm()!==a.MOscillator.OPM&&(0===this.m_volMode?this.m_envelope1.ampSamplesLinear(d,s,v,this.m_ampLevel):this.m_envelope1.ampSamplesNonLinear(d,s,v,this.m_ampLevel,this.m_volMode)),1===this.m_lfoTarget&&0!==this.m_osc2Connect)for(u=this.m_osc2Sign*this.m_lfoDepth/127,f=s,g=s;g<v;g++)c=1,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(c+=this.m_oscMod2.getNextSample()*u),c<0&&(c=0),d[g]*=c,this.m_onCounter++;if(M&&this.m_ringSens>=1e-6)for(_=o.s_pipeArr[this.m_ringPipe],h=this.m_ringSens,g=s;g<v;g++)d[g]*=_[g]*h;if(n=M,(M=M||this.m_formant.checkToSilence())!==n&&d.fill(0,s,s+i),M&&this.m_formant.run(d,s,v),n=M,(M=M||this.m_filter.checkToSilence())!==n&&d.fill(0,s,s+i),M)if(2===this.m_lfoTarget&&0!==this.m_osc2Connect){u=this.m_osc2Sign*this.m_lfoDepth,f=s;do{(S=f+o.s_lfoDelta)>v&&(S=v),l=this.m_lpfFrq,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(l+=this.m_oscMod2.getNextSample()*u|0,this.m_oscMod2.addPhase(S-f-1)),l<0?l=0:l>127*o.PITCH_RESOLUTION&&(l=127*o.PITCH_RESOLUTION),this.m_filter.run(o.s_samples,f,S,this.m_envelope2,l,this.m_lpfAmt,this.m_lpfRes,E),this.m_onCounter+=S-f,f=S}while(f<v)}else this.m_filter.run(d,s,v,this.m_envelope2,this.m_lpfFrq,this.m_lpfAmt,this.m_lpfRes,E);if(M)switch(this.m_outMode){case 0:var P=t[0],b=t[1];if(5===this.m_lfoTarget&&0!==this.m_osc2Connect)for(u=this.m_osc2Sign*this.m_lfoDepth*(1/127),g=s;g<v;g++)(p=this.m_pan+this.m_oscMod2.getNextSample()*u)<0?p=0:p>1&&(p=1),m=(r=.5*d[g])*p,P[g]+=r-m,b[g]+=m;else for(g=s;g<v;g++)m=(r=.5*d[g])*this.m_pan,P[g]+=r-m,b[g]+=m;break;case 1:if(_=o.s_pipeArr[this.m_outPipe],!1===this.m_slaveVoice)for(g=s;g<v;g++)_[g]=d[g];else for(g=s;g<v;g++)_[g]+=d[g];break;case 2:for(_=o.s_pipeArr[this.m_outPipe],g=s;g<v;g++)_[g]+=d[g]}else 1===this.m_outMode&&(_=o.s_pipeArr[this.m_outPipe],!1===this.m_slaveVoice&&_.fill(0,s,s+i))}getSamples___(t,e,s){this.m_oscMod1.getSamples(t,e,s)}getSamples_P_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=this.m_oscMod1,m=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=m.getNextSample()*r|0,m.addPhase(i-_-1)),a.setFrequency(o.getFrequency(h)),a.getSamples(t,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamples_W_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth*.01,m=this.m_oscSet1.getMod(a.MOscillator.PULSE),n=this.m_oscMod1,c=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=c.getNextSample()*r,c.addPhase(i-_-1)),h<0?h=0:h>100&&(h=100),m.setPWM(h),n.getSamples(t,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesF__(t,e,s){var i,h=this.m_inSens,_=o.s_pipeArr[this.m_inPipe],r=this.m_oscMod1;for(r.setFrequency(o.getFrequency(this.m_freqNo)),i=e;i<s;i++)t[i]=r.getNextSampleOfs(_[i]*h)}getSamplesFP_(t,e,s){var i,h,_=this.m_inSens,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_pipeArr[this.m_inPipe],m=this.m_oscMod1,n=this.m_oscMod2;for(i=e;i<s;i++)h=this.m_freqNo,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0),m.setFrequency(o.getFrequency(h)),t[i]=m.getNextSampleOfs(a[i]*_),this.m_onCounter++}getSamplesFW_(t,e,s){var i,h,_=this.m_osc2Sign*this.m_lfoDepth*.01,r=this.m_oscSet1.getMod(a.MOscillator.PULSE),m=this.m_inSens,n=o.s_pipeArr[this.m_inPipe],c=this.m_oscMod1,l=this.m_oscMod2;for(c.setFrequency(o.getFrequency(this.m_freqNo)),i=e;i<s;i++)h=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=l.getNextSample()*_),h<0?h=0:h>100&&(h=100),r.setPWM(h),t[i]=c.getNextSampleOfs(n[i]*m),this.m_onCounter++}getSamplesFF_(t,e,s){var i,h,_=this.m_osc2Sign*this.m_lfoDepth*(1/127),r=o.s_pipeArr[this.m_inPipe],a=this.m_oscMod1,m=this.m_oscMod2;for(a.setFrequency(o.getFrequency(this.m_freqNo)),i=e;i<s;i++)h=this.m_inSens,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h*=m.getNextSample()*_),t[i]=a.getNextSampleOfs(r[i]*h),this.m_onCounter++}getSamplesI__(t,e,s){this.m_oscMod1.getSamplesWithSyncIn(t,o.s_syncSources[this.m_syncPipe],e,s)}getSamplesIP_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_syncSources[this.m_syncPipe],m=this.m_oscMod1,n=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0,n.addPhase(i-_-1)),m.setFrequency(o.getFrequency(h)),m.getSamplesWithSyncIn(t,a,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesIW_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth*.01,m=this.m_oscSet1.getMod(a.MOscillator.PULSE),n=o.s_syncSources[this.m_syncPipe],c=this.m_oscMod1,l=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=l.getNextSample()*r,l.addPhase(i-_-1)),h<0?h=0:h>100&&(h=100),m.setPWM(h),c.getSamplesWithSyncIn(t,n,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesO__(t,e,s){this.m_oscMod1.getSamplesWithSyncOut(t,o.s_syncSources[this.m_syncPipe],e,s)}getSamplesOP_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_syncSources[this.m_syncPipe],m=this.m_oscMod1,n=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0,n.addPhase(i-_-1)),m.setFrequency(o.getFrequency(h)),m.getSamplesWithSyncOut(t,a,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesOW_(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth*.01,m=this.m_oscSet1.getMod(a.MOscillator.PULSE),n=o.s_syncSources[this.m_syncPipe],c=this.m_oscMod1,l=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=l.getNextSample()*r,l.addPhase(i-_-1)),h<0?h=0:h>100&&(h=100),m.setPWM(h),c.getSamplesWithSyncOut(t,n,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamples__P(t,e,s){var i,h,_=e,r=this.m_oscMod1;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),r.setFrequency(o.getFrequency(h)),r.getSamples(t,_,i),_=i}while(_<s);0===this.m_portDepth&&r.setFrequency(o.getFrequency(this.m_freqNo))}getSamples_PP(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=this.m_oscMod1,m=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=m.getNextSample()*r,m.addPhase(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),a.setFrequency(o.getFrequency(h)),a.getSamples(t,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamples_WP(t,e,s){var i,h,_,r=e,m=this.m_osc2Sign*this.m_lfoDepth*.01,n=this.m_oscSet1.getMod(a.MOscillator.PULSE),c=this.m_oscMod1,l=this.m_oscMod2;do{(i=r+o.s_lfoDelta)>s&&(i=s),_=this.m_freqNo,0!==this.m_portDepth&&(_+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-r-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),c.setFrequency(o.getFrequency(_)),h=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=l.getNextSample()*m,l.addPhase(i-r-1)),h<0?h=0:h>100&&(h=100),n.setPWM(h),c.getSamples(t,r,i),this.m_onCounter+=i-r,r=i}while(r<s);0===this.m_portDepth&&c.setFrequency(o.getFrequency(this.m_freqNo))}getSamplesF_P(t,e,s){var i,h,_=this.m_inSens,r=o.s_pipeArr[this.m_inPipe],a=this.m_oscMod1;for(h=e;h<s;h++)i=this.m_freqNo,0!==this.m_portDepth&&(i+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd,this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),a.setFrequency(o.getFrequency(i)),t[h]=a.getNextSampleOfs(r[h]*_)}getSamplesFPP(t,e,s){var i,h,_=this.m_inSens,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_pipeArr[this.m_inPipe],m=this.m_oscMod1,n=this.m_oscMod2;for(i=e;i<s;i++)h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd,this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0),m.setFrequency(o.getFrequency(h)),t[i]=m.getNextSampleOfs(a[i]*_),this.m_onCounter++}getSamplesFWP(t,e,s){var i,h,_,r=this.m_osc2Sign*this.m_lfoDepth*.01,m=this.m_oscSet1.getMod(a.MOscillator.PULSE),n=this.m_inSens,c=o.s_pipeArr[this.m_inPipe],l=this.m_oscMod1,p=this.m_oscMod2;for(i=e;i<s;i++)h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd,this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),l.setFrequency(o.getFrequency(h)),_=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(_+=p.getNextSample()*r),_<0?_=0:_>100&&(_=100),m.setPWM(_),t[i]=l.getNextSampleOfs(c[i]*n),this.m_onCounter++}getSamplesFFP(t,e,s){var i,h,_,r=this.m_osc2Sign*this.m_lfoDepth*(1/127),a=o.s_pipeArr[this.m_inPipe],m=this.m_oscMod1,n=this.m_oscMod2;for(i=e;i<s;i++)h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd,this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),m.setFrequency(o.getFrequency(h)),_=this.m_inSens,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(_*=n.getNextSample()*r),t[i]=m.getNextSampleOfs(a[i]*_),this.m_onCounter++}getSamplesI_P(t,e,s){var i,h,_=e,r=o.s_syncSources[this.m_syncPipe],a=this.m_oscMod1;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),a.setFrequency(o.getFrequency(h)),a.getSamplesWithSyncIn(t,r,_,i),this.m_onCounter+=i-_,_=i}while(_<s);0===this.m_portDepth&&a.setFrequency(o.getFrequency(this.m_freqNo))}getSamplesIPP(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_syncSources[this.m_syncPipe],m=this.m_oscMod1,n=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0,n.addPhase(i-_-1)),m.setFrequency(o.getFrequency(h)),m.getSamplesWithSyncIn(t,a,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesIWP(t,e,s){var i,h,_,r=e,m=this.m_osc2Sign*this.m_lfoDepth*.01,n=this.m_oscSet1.getMod(a.MOscillator.PULSE),c=o.s_syncSources[this.m_syncPipe],l=this.m_oscMod1,p=this.m_oscMod2;do{(i=r+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-r-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),l.setFrequency(o.getFrequency(h)),_=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(_+=p.getNextSample()*m,p.addPhase(i-r-1)),_<0?_=0:_>100&&(_=100),n.setPWM(_),l.getSamplesWithSyncIn(t,c,r,i),this.m_onCounter+=i-r,r=i}while(r<s);0===this.m_portDepth&&l.setFrequency(o.getFrequency(this.m_freqNo))}getSamplesO_P(t,e,s){var i,h,_=e,r=o.s_syncSources[this.m_syncPipe],a=this.m_oscMod1;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),a.setFrequency(o.getFrequency(h)),a.getSamplesWithSyncOut(t,r,_,i),this.m_onCounter+=i-_,_=i}while(_<s);0===this.m_portDepth&&a.setFrequency(o.getFrequency(this.m_freqNo))}getSamplesOPP(t,e,s){var i,h,_=e,r=this.m_osc2Sign*this.m_lfoDepth,a=o.s_syncSources[this.m_syncPipe],m=this.m_oscMod1,n=this.m_oscMod2;do{(i=_+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-_-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(h+=n.getNextSample()*r|0,n.addPhase(i-_-1)),m.setFrequency(o.getFrequency(h)),m.getSamplesWithSyncOut(t,a,_,i),this.m_onCounter+=i-_,_=i}while(_<s)}getSamplesOWP(t,e,s){var i,h,_,r=e,m=this.m_osc2Sign*this.m_lfoDepth*.01,n=this.m_oscSet1.getMod(a.MOscillator.PULSE),c=o.s_syncSources[this.m_syncPipe],l=this.m_oscMod1,p=this.m_oscMod2;do{(i=r+o.s_lfoDelta)>s&&(i=s),h=this.m_freqNo,0!==this.m_portDepth&&(h+=0|this.m_portDepth,this.m_portDepth+=this.m_portDepthAdd*(i-r-1),this.m_portDepth*this.m_portDepthAdd>0&&(this.m_portDepth=0)),l.setFrequency(o.getFrequency(h)),_=this.m_pulseWidth,this.m_onCounter>=this.m_lfoDelay&&(0===this.m_lfoEnd||this.m_onCounter<this.m_lfoEnd)&&(_+=p.getNextSample()*m,p.addPhase(i-r-1)),_<0?_=0:_>100&&(_=100),n.setPWM(_),l.getSamplesWithSyncOut(t,c,r,i),this.m_onCounter+=i-r,r=i}while(r<s);0===this.m_portDepth&&l.setFrequency(o.getFrequency(this.m_freqNo))}}e.MChannel=o,o.PITCH_RESOLUTION=100,o.s_init=0,o.s_frequencyMap=new Array(128*o.PITCH_RESOLUTION),o.s_lfoDelta=245}.apply(e,i))||(t.exports=h)},721:(t,e,s)=>{var i,h;i=[s,e,s(587),s(833)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MEnvelope=void 0;class h{constructor(t,e,s,i){this.setAttack(t),this.addPoint(e,s),this.setRelease(i),this.m_playing=!1,this.m_currentVal=0,this.m_releasing=!0,this.m_releaseStep=0}static boot(){if(!this.s_init){var t;for(this.s_volumeLen=256,t=0;t<3;t++)this.s_volumeMap[t]=new Array(this.s_volumeLen),this.s_volumeMap[t][0]=0;for(t=1;t<this.s_volumeLen;t++)this.s_volumeMap[0][t]=t/255,this.s_volumeMap[1][t]=Math.pow(10,48/5100*(t-255)),this.s_volumeMap[2][t]=Math.pow(10,96/5100*(t-255));this.s_init=1}}setAttack(t){this.m_envelopePoint=this.m_envelopeLastPoint=new i.MEnvelopePoint,this.m_envelopePoint.time=0,this.m_envelopePoint.level=0,this.addPoint(t,1)}setRelease(t){if(this.m_releaseTime=(t>0?t:1/127)*s.SAMPLE_RATE,this.m_playing&&!this.m_releasing){for(this.m_counter=this.m_timeInSamples,this.m_currentPoint=this.m_envelopePoint;null!==this.m_currentPoint.next&&this.m_counter>=this.m_currentPoint.next.time;)this.m_currentPoint=this.m_currentPoint.next,this.m_counter-=this.m_currentPoint.time;null==this.m_currentPoint.next?this.m_currentVal=this.m_currentPoint.level:(this.m_step=(this.m_currentPoint.next.level-this.m_currentPoint.level)/this.m_currentPoint.next.time,this.m_currentVal=this.m_currentPoint.level+this.m_step*this.m_counter)}}addPoint(t,e){var h=new i.MEnvelopePoint;h.time=t*s.SAMPLE_RATE,h.level=e,this.m_envelopeLastPoint.next=h,this.m_envelopeLastPoint=h}triggerEnvelope(t){this.m_playing=!0,this.m_releasing=!1,this.m_currentPoint=this.m_envelopePoint,this.m_currentVal=this.m_currentPoint.level=t?0:this.m_currentVal,this.m_step=(1-this.m_currentVal)/this.m_currentPoint.next.time,this.m_timeInSamples=this.m_counter=0}releaseEnvelope(){this.m_releasing=!0,this.m_releaseStep=this.m_currentVal/this.m_releaseTime}soundOff(){this.releaseEnvelope(),this.m_playing=!1}getNextAmplitudeLinear(){if(!this.m_playing)return 0;if(this.m_releasing)this.m_currentVal-=this.m_releaseStep;else if(null==this.m_currentPoint.next)this.m_currentVal=this.m_currentPoint.level;else{for(var t=!1;this.m_counter>=this.m_currentPoint.next.time;){if(this.m_counter=0,this.m_currentPoint=this.m_currentPoint.next,null==this.m_currentPoint.next){this.m_currentVal=this.m_currentPoint.level,t=!0;break}this.m_step=(this.m_currentPoint.next.level-this.m_currentPoint.level)/this.m_currentPoint.next.time,this.m_currentVal=this.m_currentPoint.level,t=!0}t||(this.m_currentVal+=this.m_step),this.m_counter++}return this.m_currentVal<=0&&this.m_releasing&&(this.m_playing=!1,this.m_currentVal=0),this.m_timeInSamples++,this.m_currentVal}ampSamplesLinear(t,e,s,i){var h,_=this.m_currentVal*i;for(h=e;h<s;h++)if(this.m_playing){if(this.m_releasing)this.m_currentVal-=this.m_releaseStep,_=this.m_currentVal*i;else if(null==this.m_currentPoint.next);else{for(var r=!1;this.m_counter>=this.m_currentPoint.next.time;){if(this.m_counter=0,this.m_currentPoint=this.m_currentPoint.next,null==this.m_currentPoint.next){this.m_currentVal=this.m_currentPoint.level,r=!0;break}this.m_step=(this.m_currentPoint.next.level-this.m_currentPoint.level)/this.m_currentPoint.next.time,this.m_currentVal=this.m_currentPoint.level,r=!0}r||(this.m_currentVal+=this.m_step),_=this.m_currentVal*i,this.m_counter++}this.m_currentVal<=0&&this.m_releasing&&(this.m_playing=!1,_=this.m_currentVal=0),this.m_timeInSamples++,t[h]*=_}else t[h]=0}ampSamplesNonLinear(t,e,s,i,_){var r;for(r=e;r<s;r++)if(this.m_playing){if(this.m_releasing)this.m_currentVal-=this.m_releaseStep;else if(null==this.m_currentPoint.next)this.m_currentVal=this.m_currentPoint.level;else{for(var a=!1;this.m_counter>=this.m_currentPoint.next.time;){if(this.m_counter=0,this.m_currentPoint=this.m_currentPoint.next,null==this.m_currentPoint.next){this.m_currentVal=this.m_currentPoint.level,a=!0;break}this.m_step=(this.m_currentPoint.next.level-this.m_currentPoint.level)/this.m_currentPoint.next.time,this.m_currentVal=this.m_currentPoint.level,a=!0}a||(this.m_currentVal+=this.m_step),this.m_counter++}this.m_currentVal<=0&&this.m_releasing&&(this.m_playing=!1,this.m_currentVal=0),this.m_timeInSamples++;var o=255*this.m_currentVal|0;o>255&&(o=0),t[r]*=h.s_volumeMap[_][o]*i}else t[r]=0}isPlaying(){return this.m_playing}isReleasing(){return this.m_releasing}}e.MEnvelope=h,h.s_init=0,h.s_volumeMap=new Array(3)}.apply(e,i))||(t.exports=h)},833:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MEnvelopePoint=void 0,e.MEnvelopePoint=class{constructor(){this.next=null}}}.apply(e,[s,e]))||(t.exports=i)},42:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MEvent=void 0,e.MEvent=class{constructor(t){this.set(1,0,0),this.setTick(t)}set(t,e,s){this.m_status=t,this.m_data0=e,this.m_data1=s}setEOT(){this.set(0,0,0)}setNoteOn(t,e){this.set(2,t,e)}setNoteOff(t,e){this.set(3,t,e)}setTempo(t){this.set(4,100*t,0)}setVolume(t){this.set(5,t,0)}setNote(t){this.set(6,t,0)}setForm(t,e){this.set(7,t,e)}setEnvelope1Atk(t){this.set(8,t,0)}setEnvelope1Point(t,e){this.set(9,t,e)}setEnvelope1Rel(t){this.set(10,t,0)}setEnvelope2Atk(t){this.set(24,t,0)}setEnvelope2Point(t,e){this.set(25,t,e)}setEnvelope2Rel(t){this.set(26,t,0)}setNoiseFreq(t){this.set(11,t,0)}setPWM(t){this.set(12,t,0)}setPan(t){this.set(13,t,0)}setFormant(t){this.set(14,t,0)}setDetune(t){this.set(15,t,0)}setLFOFMSF(t,e){this.set(16,t,e)}setLFODPWD(t,e){this.set(17,t,e)}setLFODLTM(t,e){this.set(18,t,e)}setLFOTarget(t){this.set(19,t,0)}setLPFSWTAMT(t,e){this.set(20,t,e)}setLPFFRQRES(t,e){this.set(21,t,e)}setClose(){this.set(22,0,0)}setVolMode(t){this.set(23,t,0)}setInput(t,e){this.set(27,t,e)}setOutput(t,e){this.set(28,t,e)}setExpression(t){this.set(29,t,0)}setRing(t,e){this.set(30,t,e)}setSync(t,e){this.set(31,t,e)}setDelta(t){this.m_delta=t}setTick(t){this.m_tick=t}setPortamento(t,e){this.set(32,t,e)}setMidiPort(t){this.set(33,t,0)}setMidiPortRate(t){this.set(34,t,0)}setPortBase(t){this.set(35,t,0)}setPoly(t){this.set(36,t,0)}setResetAll(){this.set(38,0,0)}setSoundOff(){this.set(37,0,0)}setHwLfo(t,e,s,i,h,_,r){this.set(39,(3&t)<<27|(255&e)<<19|(127&s)<<12|(127&i)<<5|(7&h)<<2|3&_,0)}getStatus(){return this.m_status}getDelta(){return this.m_delta}getTick(){return this.m_tick}getNoteNo(){return this.m_data0}getVelocity(){return this.m_data1}getTempo(){return Math.floor(this.m_data0)/100}getVolume(){return this.m_data0}getForm(){return this.m_data0}getSubForm(){return this.m_data1}getEnvelopeA(){return this.m_data0}getEnvelopeT(){return this.m_data0}getEnvelopeL(){return this.m_data1}getEnvelopeR(){return this.m_data0}getNoiseFreq(){return this.m_data0}getPWM(){return this.m_data0}getPan(){return this.m_data0}getVowel(){return this.m_data0}getDetune(){return this.m_data0}getLFODepth(){return this.m_data0}getLFOWidth(){return this.m_data1}getLFOForm(){return this.m_data0}getLFOSubForm(){return this.m_data1}getLFODelay(){return this.m_data0}getLFOTime(){return this.m_data1}getLFOTarget(){return this.m_data0}getLPFSwt(){return this.m_data0}getLPFAmt(){return this.m_data1}getLPFFrq(){return this.m_data0}getLPFRes(){return this.m_data1}getVolMode(){return this.m_data0}getInputSens(){return this.m_data0}getInputPipe(){return this.m_data1}getOutputMode(){return this.m_data0}getOutputPipe(){return this.m_data1}getExpression(){return this.m_data0}getRingSens(){return this.m_data0}getRingInput(){return this.m_data1}getSyncMode(){return this.m_data0}getSyncPipe(){return this.m_data1}getPorDepth(){return this.m_data0}getPorLen(){return this.m_data1}getMidiPort(){return this.m_data0}getMidiPortRate(){return this.m_data0}getPortBase(){return this.m_data0}getVoiceCount(){return this.m_data0}getHwLfoData(){return this.m_data0}}}.apply(e,[s,e]))||(t.exports=i)},208:(t,e,s)=>{var i,h;i=[s,e,s(587),s(870)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MFilter=void 0,e.MFilter=class{constructor(){this.setSwitch(0)}reset(){this.m_t1=this.m_t2=this.m_b0=this.m_b1=this.m_b2=this.m_b3=this.m_b4=0}setSwitch(t){this.reset(),this.sw=t}checkToSilence(){switch(this.sw){case 0:return!1;case 1:case-1:return-1e-6<=this.m_b0&&this.m_b0<=1e-6&&-1e-6<=this.m_b1&&this.m_b1<=1e-6;case 2:case-2:return-1e-6<=this.m_t1&&this.m_t1<=1e-6&&-1e-6<=this.m_t2&&this.m_t2<=1e-6&&-1e-6<=this.m_b0&&this.m_b0<=1e-6&&-1e-6<=this.m_b1&&this.m_b1<=1e-6&&-1e-6<=this.m_b2&&this.m_b2<=1e-6&&-1e-6<=this.m_b3&&this.m_b3<=1e-6&&-1e-6<=this.m_b4&&this.m_b4<=1e-6}return!1}run(t,e,s,i,h,_,r,a){switch(this.sw){case-2:this.hpf2(t,e,s,i,h,_,r,a);break;case-1:this.hpf1(t,e,s,i,h,_,r,a);break;case 0:return;case 1:this.lpf1(t,e,s,i,h,_,r,a);break;case 2:this.lpf2(t,e,s,i,h,_,r,a)}}lpf1(t,e,h,_,r,a,o,m){var n,c,l,p=this.m_b0,u=this.m_b1,g=m*(2*Math.PI/(440*s.SAMPLE_RATE));if(a>1e-4||a<-1e-4)for(n=e;n<h;n++)(l=i.MChannel.getFrequency(r+a*_.getNextAmplitudeLinear())*g)<1/127&&(l=0),l>.9999&&(l=.9999),c=o+o/(1-l),p+=l*(t[n]-p+c*(p-u)),t[n]=u+=l*(p-u);else for((l=i.MChannel.getFrequency(r)*g)<1/127&&(l=0),l>.9999&&(l=.9999),c=o+o/(1-l),n=e;n<h;n++)p+=l*(t[n]-p+c*(p-u)),t[n]=u+=l*(p-u);this.m_b0=p,this.m_b1=u}lpf2(t,e,h,_,r,a,o,m){for(var n=this.m_t1,c=this.m_t2,l=this.m_b0,p=this.m_b1,u=this.m_b2,g=this.m_b3,f=this.m_b4,S=m*(2*Math.PI/(440*s.SAMPLE_RATE)),v=e;v<h;v++){var d=i.MChannel.getFrequency(r+a*_.getNextAmplitudeLinear())*S;d<1/127&&(d=0),d>1&&(d=1);var M=1-d,E=d+.8*d*M,P=E+E-1;M=o*(1+.5*M*(1-M+5.6*M*M));var b=t[v];n=p,c=u,u=((p=((b-=M*f)+l)*E-p*P)+n)*E-u*P,n=g,f=((g=(u+c)*E-g*P)+n)*E-f*P,f-=f*f*f*.166667,l=b,t[v]=f}this.m_t1=n,this.m_t2=c,this.m_b0=l,this.m_b1=p,this.m_b2=u,this.m_b3=g,this.m_b4=f}hpf1(t,e,h,_,r,a,o,m){var n,c,l,p,u=this.m_b0,g=this.m_b1,f=m*(2*Math.PI/(440*s.SAMPLE_RATE));if(a>1e-4||a<-1e-4)for(n=e;n<h;n++)(l=i.MChannel.getFrequency(r+a*_.getNextAmplitudeLinear())*f)<1/127&&(l=0),l>.9999&&(l=.9999),c=o+o/(1-l),g+=l*((u+=l*((p=t[n])-u+c*(u-g)))-g),t[n]=p-u;else for((l=i.MChannel.getFrequency(r)*f)<1/127&&(l=0),l>.9999&&(l=.9999),c=o+o/(1-l),n=e;n<h;n++)g+=l*((u+=l*((p=t[n])-u+c*(u-g)))-g),t[n]=p-u;this.m_b0=u,this.m_b1=g}hpf2(t,e,h,_,r,a,o,m){for(var n=this.m_t1,c=this.m_t2,l=this.m_b0,p=this.m_b1,u=this.m_b2,g=this.m_b3,f=this.m_b4,S=m*(2*Math.PI/(440*s.SAMPLE_RATE)),v=e;v<h;v++){var d=i.MChannel.getFrequency(r+a*_.getNextAmplitudeLinear())*S;d<1/127&&(d=0),d>1&&(d=1);var M=1-d,E=d+.8*d*M,P=E+E-1;M=o*(1+.5*M*(1-M+5.6*M*M));var b=t[v];n=p,c=u,u=((p=((b-=M*f)+l)*E-p*P)+n)*E-u*P,n=g,f=((g=(u+c)*E-g*P)+n)*E-f*P,f-=f*f*f*.166667,l=b,t[v]=b-f}this.m_t1=n,this.m_t2=c,this.m_b0=l,this.m_b1=p,this.m_b2=u,this.m_b3=g,this.m_b4=f}}}.apply(e,i))||(t.exports=h)},795:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MFormant=void 0;class s{constructor(){this.m_ca0=811044e-11,this.m_ca1=8.943665402,this.m_ca2=-36.83889529,this.m_ca3=92.01697887,this.m_ca4=-154.337906,this.m_ca5=181.6233289,this.m_ca6=-151.8651235,this.m_ca7=89.09614114,this.m_ca8=-35.10298511,this.m_ca9=8.388101016,this.m_caA=-.923313471,this.m_ce0=436215e-11,this.m_ce1=8.90438318,this.m_ce2=-36.55179099,this.m_ce3=91.05750846,this.m_ce4=-152.422234,this.m_ce5=179.1170248,this.m_ce6=-149.6496211,this.m_ce7=87.78352223,this.m_ce8=-34.60687431,this.m_ce9=8.282228154,this.m_ceA=-.914150747,this.m_ci0=333819e-11,this.m_ci1=8.893102966,this.m_ci2=-36.49532826,this.m_ci3=90.96543286,this.m_ci4=-152.4545478,this.m_ci5=179.4835618,this.m_ci6=-150.315433,this.m_ci7=88.43409371,this.m_ci8=-34.98612086,this.m_ci9=8.407803364,this.m_ciA=-.932568035,this.m_co0=113572e-11,this.m_co1=8.994734087,this.m_co2=-37.2084849,this.m_co3=93.22900521,this.m_co4=-156.6929844,this.m_co5=184.596544,this.m_co6=-154.3755513,this.m_co7=90.49663749,this.m_co8=-35.58964535,this.m_co9=8.478996281,this.m_coA=-.929252233,this.m_cu0=4.09431e-7,this.m_cu1=8.997322763,this.m_cu2=-37.20218544,this.m_cu3=93.11385476,this.m_cu4=-156.2530937,this.m_cu5=183.7080141,this.m_cu6=-153.2631681,this.m_cu7=89.59539726,this.m_cu8=-35.12454591,this.m_cu9=8.338655623,this.m_cuA=-.910251753,this.m_vowel=s.VOWEL_A,this.m_power=!1,this.reset()}setVowel(t){this.m_power=!0,this.m_vowel=t}disable(){this.m_power=!1,this.reset()}reset(){this.m_m0=this.m_m1=this.m_m2=this.m_m3=this.m_m4=this.m_m5=this.m_m6=this.m_m7=this.m_m8=this.m_m9=0}checkToSilence(){return this.m_power&&-1e-6<=this.m_m0&&this.m_m0<=1e-6&&-1e-6<=this.m_m1&&this.m_m1<=1e-6&&-1e-6<=this.m_m2&&this.m_m2<=1e-6&&-1e-6<=this.m_m3&&this.m_m3<=1e-6&&-1e-6<=this.m_m4&&this.m_m4<=1e-6&&-1e-6<=this.m_m5&&this.m_m5<=1e-6&&-1e-6<=this.m_m6&&this.m_m6<=1e-6&&-1e-6<=this.m_m7&&this.m_m7<=1e-6&&-1e-6<=this.m_m8&&this.m_m8<=1e-6&&-1e-6<=this.m_m9&&this.m_m9<=1e-6}run(t,e,s){var i;if(this.m_power)switch(this.m_vowel){case 0:for(i=e;i<s;i++)t[i]=this.m_ca0*t[i]+this.m_ca1*this.m_m0+this.m_ca2*this.m_m1+this.m_ca3*this.m_m2+this.m_ca4*this.m_m3+this.m_ca5*this.m_m4+this.m_ca6*this.m_m5+this.m_ca7*this.m_m6+this.m_ca8*this.m_m7+this.m_ca9*this.m_m8+this.m_caA*this.m_m9,this.m_m9=this.m_m8,this.m_m8=this.m_m7,this.m_m7=this.m_m6,this.m_m6=this.m_m5,this.m_m5=this.m_m4,this.m_m4=this.m_m3,this.m_m3=this.m_m2,this.m_m2=this.m_m1,this.m_m1=this.m_m0,this.m_m0=t[i];return;case 1:for(i=e;i<s;i++)t[i]=this.m_ce0*t[i]+this.m_ce1*this.m_m0+this.m_ce2*this.m_m1+this.m_ce3*this.m_m2+this.m_ce4*this.m_m3+this.m_ce5*this.m_m4+this.m_ce6*this.m_m5+this.m_ce7*this.m_m6+this.m_ce8*this.m_m7+this.m_ce9*this.m_m8+this.m_ceA*this.m_m9,this.m_m9=this.m_m8,this.m_m8=this.m_m7,this.m_m7=this.m_m6,this.m_m6=this.m_m5,this.m_m5=this.m_m4,this.m_m4=this.m_m3,this.m_m3=this.m_m2,this.m_m2=this.m_m1,this.m_m1=this.m_m0,this.m_m0=t[i];return;case 2:for(i=e;i<s;i++)t[i]=this.m_ci0*t[i]+this.m_ci1*this.m_m0+this.m_ci2*this.m_m1+this.m_ci3*this.m_m2+this.m_ci4*this.m_m3+this.m_ci5*this.m_m4+this.m_ci6*this.m_m5+this.m_ci7*this.m_m6+this.m_ci8*this.m_m7+this.m_ci9*this.m_m8+this.m_ciA*this.m_m9,this.m_m9=this.m_m8,this.m_m8=this.m_m7,this.m_m7=this.m_m6,this.m_m6=this.m_m5,this.m_m5=this.m_m4,this.m_m4=this.m_m3,this.m_m3=this.m_m2,this.m_m2=this.m_m1,this.m_m1=this.m_m0,this.m_m0=t[i];return;case 3:for(i=e;i<s;i++)t[i]=this.m_co0*t[i]+this.m_co1*this.m_m0+this.m_co2*this.m_m1+this.m_co3*this.m_m2+this.m_co4*this.m_m3+this.m_co5*this.m_m4+this.m_co6*this.m_m5+this.m_co7*this.m_m6+this.m_co8*this.m_m7+this.m_co9*this.m_m8+this.m_coA*this.m_m9,this.m_m9=this.m_m8,this.m_m8=this.m_m7,this.m_m7=this.m_m6,this.m_m6=this.m_m5,this.m_m5=this.m_m4,this.m_m4=this.m_m3,this.m_m3=this.m_m2,this.m_m2=this.m_m1,this.m_m1=this.m_m0,this.m_m0=t[i];return;case 4:for(i=e;i<s;i++)t[i]=this.m_cu0*t[i]+this.m_cu1*this.m_m0+this.m_cu2*this.m_m1+this.m_cu3*this.m_m2+this.m_cu4*this.m_m3+this.m_cu5*this.m_m4+this.m_cu6*this.m_m5+this.m_cu7*this.m_m6+this.m_cu8*this.m_m7+this.m_cu9*this.m_m8+this.m_cuA*this.m_m9,this.m_m9=this.m_m8,this.m_m8=this.m_m7,this.m_m7=this.m_m6,this.m_m6=this.m_m5,this.m_m5=this.m_m4,this.m_m4=this.m_m3,this.m_m3=this.m_m2,this.m_m2=this.m_m1,this.m_m1=this.m_m0,this.m_m0=t[i];return}}}e.MFormant=s,s.VOWEL_A=0,s.VOWEL_E=1,s.VOWEL_I=2,s.VOWEL_O=3,s.VOWEL_U=4}.apply(e,[s,e]))||(t.exports=i)},565:(t,e,s)=>{var i,h;i=[s,e,s(777),s(182),s(691),s(982),s(437),s(234),s(150),s(795),s(433)],void 0===(h=function(t,e,s,i,h,_,r,a,o,m,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MML=void 0;class c{constructor(t){this.worker=t,this.m_sequencer=new a.MSequencer(t)}static isWhitespace(t){return" "===t||"\t"===t||"\n"===t||"\r"===t||"　"===t}static removeWhitespace(t){return t.replace(new RegExp("[ 　\n\r\t\f]+","g"),"")}static remove(t,e,s){return t.substring(0,e)+t.substring(s+1)}getWarnings(){return this.m_warning}warning(t,e){this.m_warning+=n.MWarning.getString(t,e)+"\n"}len2tick(t){return 0===t?this.m_length:384/t|0}note(t){if(t+=this.m_noteShift+this.getKeySig(),"*"===this.getChar())this.m_beforeNote=t+12*this.m_octave,this.m_portamento=1,this.next();else{var e,s,i,h=0,_=0,r=0===this.m_keyoff?0:1;for(this.m_keyoff=1;;){if("%"!==this.getChar()?e=0:(e=1,this.next()),s=this.getUInt(0),1===_&&0===s){this.m_keyoff=0;break}if(i=e?s:this.len2tick(s),h+=this.getDot(i),_=0,"&"!==this.getChar())break;_=1,this.next()}1===this.m_portamento&&this.m_tracks[this.m_trackNo].recPortamento(this.m_beforeNote-(t+12*this.m_octave),h),this.m_tracks[this.m_trackNo].recNote(t+12*this.m_octave,h,this.m_velocity,r,this.m_keyoff),1===this.m_portamento&&(this.m_tracks[this.m_trackNo].recPortamento(0,0),this.m_portamento=0)}}rest(){var t,e=0;"%"===this.getChar()&&(e=1,this.next()),t=this.getUInt(0);var s=e?t:this.len2tick(t);s=this.getDot(s),this.m_tracks[this.m_trackNo].recRest(s)}atmark(){var t,e,s,i,h=this.getChar(),_=1,r=0,a=64,o=32,n=0,l=0,p=0,u=0,g=0;switch(h){case"v":this.m_velDetail=!0,this.next(),this.m_velocity=this.getUInt(this.m_velocity),this.m_velocity>127&&(this.m_velocity=127);break;case"x":this.next(),(_=this.getUInt(127))>127&&(_=127),this.m_tracks[this.m_trackNo].recExpression(_);break;case"e":var f,S=new Array,v=new Array;for(this.next(),_=this.getUInt(_),","===this.getChar()&&this.next(),r=this.getUInt(r),f=this.m_letter;","===this.getChar();){if(this.next(),f=this.m_letter-1,a=this.getUInt(a),","!==this.getChar()){this.m_letter=f;break}this.next(),o=this.getUInt(o),S.push(a),v.push(o)}0===S.length&&(S.push(a),v.push(o)),","===this.getChar()&&this.next(),n=this.getUInt(n),this.m_tracks[this.m_trackNo].recEnvelope(_,r,S,v,n);break;case"m":if(this.next(),"h"===this.getChar()){this.next(),u=0,g=0,t=0,e=0,s=0,i=0,o=1;do{if(u=this.getUInt(u),","!==this.getChar())break;if(this.next(),g=this.getUInt(g),","!==this.getChar())break;if(this.next(),t=this.getUInt(t),","!==this.getChar())break;if(this.next(),e=this.getUInt(e),","!==this.getChar())break;if(this.next(),s=this.getUInt(s),","!==this.getChar())break;if(this.next(),i=this.getUInt(i),","!==this.getChar())break;this.next(),o=this.getUInt(o)}while(0);this.m_tracks[this.m_trackNo].recHwLfo(u,g,t,e,s,i,o)}break;case"n":this.next(),"s"===this.getChar()?(this.next(),this.m_noteShift+=this.getSInt(0)):(((_=this.getUInt(0))<0||_>127)&&(_=0),this.m_tracks[this.m_trackNo].recNoiseFreq(_));break;case"w":this.next(),(_=this.getSInt(50))<0?(_>-1&&(_=-1),_<-99&&(_=-99)):(_<1&&(_=1),_>99&&(_=99)),this.m_tracks[this.m_trackNo].recPWM(_);break;case"p":this.next(),"l"===this.getChar()?(this.next(),_=this.getUInt(this.m_polyVoice),_=Math.max(0,Math.min(this.m_polyVoice,_)),this.m_tracks[this.m_trackNo].recPoly(_)):((_=this.getUInt(64))<1&&(_=1),_>127&&(_=127),this.m_tracks[this.m_trackNo].recPan(_));break;case"'":if(this.next(),(_=this.m_string.indexOf("'",this.m_letter))>=0){var d=0;switch(this.m_string.substring(this.m_letter,_)){case"a":d=m.MFormant.VOWEL_A;break;case"e":d=m.MFormant.VOWEL_E;break;case"i":d=m.MFormant.VOWEL_I;break;case"o":d=m.MFormant.VOWEL_O;break;case"u":d=m.MFormant.VOWEL_U;break;default:d=-1}this.m_tracks[this.m_trackNo].recFormant(d),this.m_letter=_+1}break;case"d":this.next(),_=this.getSInt(0),this.m_tracks[this.m_trackNo].recDetune(_);break;case"l":var M=0,E=0,P=1,b=0,A=1,O=0,N=0,y=0;this.next(),M=this.getUInt(M),","===this.getChar()&&this.next(),E=this.getUInt(E),","===this.getChar()&&(this.next(),"-"===this.getChar()&&(A=-1,this.next()),P=(this.getUInt(P)+1)*A,"-"===this.getChar()&&(this.next(),b=this.getUInt(0)),","===this.getChar()&&(this.next(),O=this.getUInt(O),","===this.getChar()&&(this.next(),N=this.getUInt(N),","===this.getChar()&&(this.next(),y=this.getUInt(y))))),this.m_tracks[this.m_trackNo].recLFO(M,E,P,b,O,N,y);break;case"f":var T=0,k=0,C=0,F=0;this.next(),T=this.getSInt(T),","===this.getChar()&&(this.next(),k=this.getSInt(k),","===this.getChar()&&(this.next(),C=this.getUInt(C),","===this.getChar()&&(this.next(),F=this.getUInt(F)))),this.m_tracks[this.m_trackNo].recLPF(T,k,C,F);break;case"q":this.next(),this.m_tracks[this.m_trackNo].recGate2(2*this.getUInt(2));break;case"i":l=0,this.next(),l=this.getUInt(l),","===this.getChar()&&(this.next(),(r=this.getUInt(r))>this.m_maxPipe&&(r=this.m_maxPipe)),this.m_tracks[this.m_trackNo].recInput(l,r);break;case"o":p=0,this.next(),p=this.getUInt(p),","===this.getChar()&&(this.next(),(r=this.getUInt(r))>this.m_maxPipe&&(this.m_maxPipe=r,this.m_maxPipe>=c.MAX_PIPE&&(this.m_maxPipe=r=c.MAX_PIPE))),this.m_tracks[this.m_trackNo].recOutput(p,r);break;case"r":l=0,this.next(),l=this.getUInt(l),","===this.getChar()&&(this.next(),(r=this.getUInt(r))>this.m_maxPipe&&(r=this.m_maxPipe)),this.m_tracks[this.m_trackNo].recRing(l,r);break;case"s":p=0,this.next(),p=this.getUInt(p),","===this.getChar()&&(this.next(),r=this.getUInt(r),1===p?r>this.m_maxSyncSource&&(this.m_maxSyncSource=r,this.m_maxSyncSource>=c.MAX_SYNCSOURCE&&(this.m_maxSyncSource=r=c.MAX_SYNCSOURCE)):2===p&&r>this.m_maxSyncSource&&(r=this.m_maxSyncSource)),this.m_tracks[this.m_trackNo].recSync(p,r);break;case"u":var L;switch(this.next(),p=this.getUInt(0)){case 0:case 1:this.m_tracks[this.m_trackNo].recMidiPort(p);break;case 2:L=0,","===this.getChar()&&(this.next(),(L=this.getUInt(0))<0&&(L=0),L>127&&(L=127)),this.m_tracks[this.m_trackNo].recMidiPortRate(1*L);break;case 3:if(","===this.getChar()){var I;this.next();var x=-1;switch("o"!==this.getChar()?I=this.m_octave:(this.next(),I=this.getUInt(0)),h=this.getChar()){case"c":x=0;break;case"d":x=2;break;case"e":x=4;break;case"f":x=5;break;case"g":x=7;break;case"a":x=9;break;case"b":x=11}x>=0?(this.next(),x+=this.m_noteShift+this.getKeySig(),x+=12*I):x=this.getUInt(60),x<0&&(x=0),x>127&&(x=127),this.m_tracks[this.m_trackNo].recPortBase(x)}}break;default:this.m_form=this.getUInt(this.m_form),r=0,"-"===this.getChar()&&(this.next(),r=this.getUInt(0)),this.m_tracks[this.m_trackNo].recForm(this.m_form,r)}}firstLetter(){var t,e,s=this.getCharNext();switch(s){case"c":this.note(0);break;case"d":this.note(2);break;case"e":this.note(4);break;case"f":this.note(5);break;case"g":this.note(7);break;case"a":this.note(9);break;case"b":this.note(11);break;case"r":this.rest();break;case"o":this.m_octave=this.getUInt(this.m_octave),this.m_octave<-2&&(this.m_octave=-2),this.m_octave>8&&(this.m_octave=8);break;case"v":this.m_velDetail=!1,this.m_velocity=8*this.getUInt((this.m_velocity-7)/8)+7,this.m_velocity<0&&(this.m_velocity=0),this.m_velocity>127&&(this.m_velocity=127);break;case"(":case")":e=this.getUInt(1),"("===s&&this.m_velDir||")"===s&&!this.m_velDir?(this.m_velocity+=this.m_velDetail?1*e:8*e,this.m_velocity>127&&(this.m_velocity=127)):(this.m_velocity-=this.m_velDetail?1*e:8*e,this.m_velocity<0&&(this.m_velocity=0));break;case"l":this.m_length=this.len2tick(this.getUInt(0)),this.m_length=this.getDot(this.m_length);break;case"t":this.m_tempo=this.getUNumber(this.m_tempo),this.m_tempo<1&&(this.m_tempo=1),this.m_tracks[o.MTrack.TEMPO_TRACK].recTempo(this.m_tracks[this.m_trackNo].getRecGlobalTick(),this.m_tempo);break;case"q":this.m_gate=this.getUInt(this.m_gate),this.m_tracks[this.m_trackNo].recGate(this.m_gate/this.m_maxGate);break;case"<":this.m_relativeDir?this.m_octave++:this.m_octave--;break;case">":this.m_relativeDir?this.m_octave--:this.m_octave++;break;case";":this.m_keyoff=1,this.m_tracks[this.m_trackNo].getNumEvents()>0&&this.m_trackNo++,this.m_tracks[this.m_trackNo]=this.createTrack();break;case"@":this.atmark();break;case"x":this.m_tracks[this.m_trackNo].recVolMode(this.getUInt(1));break;case"n":"s"===(t=this.getChar())?(this.next(),this.m_noteShift=this.getSInt(this.m_noteShift)):this.warning(n.MWarning.UNKNOWN_COMMAND,s+t);break;case"[":this.m_tracks[this.m_trackNo].recChordStart();break;case"]":this.m_tracks[this.m_trackNo].recChordEnd();break;default:s.charCodeAt(0)<128&&this.warning(n.MWarning.UNKNOWN_COMMAND,s)}}getCharNext(){return this.m_letter<this.m_string.length?this.m_string.charAt(this.m_letter++):""}getChar(){return this.m_letter<this.m_string.length?this.m_string.charAt(this.m_letter):""}next(t=1){this.m_letter+=1}getKeySig(){for(var t=0,e=1;e;)switch(this.getChar()){case"+":case"#":t++,this.next();break;case"-":t--,this.next();break;default:e=0}return t}getUInt(t){for(var e=0,s=this.m_letter,i=1;i;)switch(this.getChar()){case"0":e=10*e+0,this.next();break;case"1":e=10*e+1,this.next();break;case"2":e=10*e+2,this.next();break;case"3":e=10*e+3,this.next();break;case"4":e=10*e+4,this.next();break;case"5":e=10*e+5,this.next();break;case"6":e=10*e+6,this.next();break;case"7":e=10*e+7,this.next();break;case"8":e=10*e+8,this.next();break;case"9":e=10*e+9,this.next();break;default:i=0}return this.m_letter===s?t:e}getUNumber(t){var e=this.getUInt(0|t),s=1;if("."===this.getChar()){this.next();for(var i=!0;i;)switch(s*=.1,this.getChar()){case"0":e+=0*s,this.next();break;case"1":e+=1*s,this.next();break;case"2":e+=2*s,this.next();break;case"3":e+=3*s,this.next();break;case"4":e+=4*s,this.next();break;case"5":e+=5*s,this.next();break;case"6":e+=6*s,this.next();break;case"7":e+=7*s,this.next();break;case"8":e+=8*s,this.next();break;case"9":e+=9*s,this.next();break;default:i=!1}}return e}getSInt(t){var e=this.getChar(),s=1;return"-"===e?(s=-1,this.next()):"+"===e&&this.next(),this.getUInt(t)*s}getDot(t){for(var e=this.getChar(),s=t;"."===e;)this.next(),t+=s=Math.floor(s/2),e=this.getChar();return t}createTrack(){return this.m_octave=4,this.m_velocity=100,this.m_noteShift=0,new o.MTrack}begin(){this.m_letter=0}process(){for(this.begin();this.m_letter<this.m_string.length;)this.firstLetter()}processRepeat(){this.m_string=this.m_string.toLowerCase(),this.begin();for(var t=new Array,e=new Array,s=new Array,i=new Array,h=-1;this.m_letter<this.m_string.length;)switch(this.getCharNext()){case"/":":"===this.getChar()?(this.next(),e[++h]=this.m_letter-2,t[h]=this.getUInt(2),s[h]=this.m_letter,i[h]=-1):h>=0&&(i[h]=this.m_letter-1,this.m_string=this.m_string.substring(0,this.m_letter-1)+this.m_string.substring(this.m_letter),this.m_letter--);break;case":":if("/"===this.getChar()&&h>=0){this.next();for(var _=this.m_string.substring(s[h],this.m_letter-2),r=this.m_string.substring(0,e[h]),a=0;a<t[h];a++)a<t[h]-1||i[h]<0?r+=_:r+=this.m_string.substring(s[h],i[h]);var o=r.length;r+=this.m_string.substring(this.m_letter),this.m_string=r,this.m_letter=o,h--}}h>=0&&this.warning(n.MWarning.UNCLOSED_REPEAT,"")}replaceMacro(t){for(var e in t){var s=t[e];if(this.m_string.substr(this.m_letter,s.id.length)===s.id){var i=this.m_letter,h=this.m_letter+s.id.length,_=s.code;this.m_letter+=s.id.length;for(var r=this.getCharNext();c.isWhitespace(r);)r=this.getCharNext();var a=new Array,o=0;if(s.args.length>0){if("{"===r){for(r=this.getCharNext();1===o||"}"!==r&&""!==r;)'"'===r&&(o=1-o),"$"===r&&this.replaceMacro(t),r=this.getCharNext();h=this.m_letter;for(var m=this.m_string.substring(i+s.id.length+1,h-1),l="",p=!1,u=0;u<m.length;u++)p||'"'!==m.charAt(u)?p&&u+1<m.length&&"\\"===m.charAt(u)&&'"'===m.charAt(u+1)?(l+='"',u++):p&&'"'===m.charAt(u)?p=!1:p||","!==m.charAt(u)?l+=m.charAt(u):(a.push(l),l=""):p=!0;a.push(l),p&&this.warning(n.MWarning.UNCLOSED_ARGQUOTE,"")}for(var g=0;g<_.length;g++)for(var f=0;f<a.length&&!(f>=s.args.length);f++)if(_.substr(g,s.args[f].id.length+1)==="%"+s.args[f].id){_=_.substring(0,g)+_.substring(g).replace("%"+s.args[f].id,a[s.args[f].index]),g+=a[s.args[f].index].length-1;break}}return this.m_string=this.m_string.substring(0,i-1)+_+this.m_string.substring(h),this.m_letter=i-1,!0}}return!1}processMacro(){var t,e,s,a,o=/^#OCTAVE\s+REVERSE\s*$/m;if(this.m_string.match(o)&&(this.m_string=this.m_string.replace(o,""),this.m_relativeDir=!1),o=/^#VELOCITY\s+REVERSE\s*$/m,this.m_string.match(o)&&(this.m_string=this.m_string.replace(o,""),this.m_velDir=!1),this.m_metaTitle=this.findMetaDescN("TITLE"),this.m_metaArtist=this.findMetaDescN("ARTIST"),this.m_metaComment=this.findMetaDescN("COMMENT"),this.m_metaCoding=this.findMetaDescN("CODING"),this.findMetaDescN("PRAGMA"),o=/^#OPM@(\d+)[ \t]*{([^}]*)}/gm,e=this.m_string.match(o))for(this.m_string=this.m_string.replace(o,""),t=0;t<e.length;t++)s=e[t].match(/^#OPM@(\d+)[ \t]*{([^}]*)}/m),r.MOscOPM.setTimber(parseInt(s[1]),r.MOscOPM.TYPE_OPM,s[2]);if(o=/^#OPN@(\d+)[ \t]*{([^}]*)}/gm,e=this.m_string.match(o))for(this.m_string=this.m_string.replace(o,""),t=0;t<e.length;t++)a=e[t].match(/^#OPN@(\d+)[ \t]*{([^}]*)}/m),r.MOscOPM.setTimber(parseInt(a[1]),r.MOscOPM.TYPE_OPN,a[2]);var m=this.findMetaDescV("FMGAIN");for(t=0;t<m.length;t++)r.MOscOPM.setCommonGain(20*parseInt(m[t])/127);var l=this.findMetaDescN("USING\\s+POLY");if((l=(l=(l=l.replace("\r","")).replace("\n"," ")).toLowerCase()).length>0){var p=l.split(" ");for(p.length<1?this.m_usingPoly=!1:(this.m_usingPoly=!0,this.m_polyVoice=Math.min(Math.max(1,parseInt(p[0])),c.MAX_POLYVOICE)),t=1;t<p.length;t++)"force"===p[t]&&(this.m_polyForce=!0);this.m_polyVoice<=1&&(this.m_usingPoly=!1,this.m_polyForce=!1)}if(o=/^#WAV10\s.*$/gm,e=this.m_string.match(o))for(t=0;t<e.length;t++){this.m_string=this.m_string.replace(o,"");for(var u=e[t].split(" "),g="",f=1;f<u.length;f++)g+=u[f];var S=g.split(","),v=parseInt(S[0]);v<0&&(v=0),v>=h.MOscGbWave.MAX_WAVE&&(v=h.MOscGbWave.MAX_WAVE-1),h.MOscGbWave.setWave(v,(S[1].toLowerCase()+"00000000000000000000000000000000").substr(0,32))}if(o=/^#WAV13\s.*$/gm,e=this.m_string.match(o))for(t=0;t<e.length;t++){for(this.m_string=this.m_string.replace(o,""),u=e[t].split(" "),g="",f=1;f<u.length;f++)g+=u[f];S=g.split(","),(v=parseInt(S[0]))<0&&(v=0),v>=_.MOscWave.MAX_WAVE&&(v=_.MOscWave.MAX_WAVE-1),_.MOscWave.setWave(v,S[1].toLowerCase())}if(o=/^#WAV9\s.*$/gm,e=this.m_string.match(o))for(t=0;t<e.length;t++){for(this.m_string=this.m_string.replace(o,""),u=e[t].split(" "),g="",f=1;f<u.length;f++)g+=u[f];S=g.split(","),(v=parseInt(S[0]))<0&&(v=0),v>=i.MOscFcDpcm.MAX_WAVE&&(v=i.MOscFcDpcm.MAX_WAVE-1);var d=parseInt(S[1]);d<0&&(d=0),d>127&&(d=127);var M=parseInt(S[2]);M<0&&(M=0),M>1&&(M=1),i.MOscFcDpcm.setWave(v,d,M,S[3])}this.begin();for(var E=!0,P=new Array,b=/^\s*/m,A=/\s*$/m;this.m_letter<this.m_string.length;){var O=this.getCharNext();switch(O){case"$":if(E){var N=this.m_string.indexOf(";",this.m_letter);if(N>this.m_letter){var y=this.m_string.indexOf("=",this.m_letter);if(y>this.m_letter&&y<N){var T=this.m_letter,k=this.m_string.indexOf("{");(k<0||k>=y)&&(k=y);var C=this.m_string.substring(T,k),F=C.match("[a-zA-Z_][a-zA-Z_0-9#+()]*");if(null!==F){var L=F[0];if((C=C.replace(b,"").replace(A,""))!==L&&this.warning(n.MWarning.INVALID_MACRO_NAME,C),L.length>0){var I=new Array;if(k<y){for(I=this.m_string.substring(k+1,this.m_string.indexOf("}",k)).split(","),t=0;t<I.length;t++){var x=I[t].match("[a-zA-Z_][a-zA-Z_0-9#+()]*");I[t]={id:null!==x?x[0]:"",index:t}}I.sort(((t,e)=>t.id.length>e.id.length?-1:t.id.length===e.id.length?0:1))}for(this.m_letter=y+1,O=this.getCharNext();this.m_letter<N;)"$"===O&&(this.replaceMacro(P)||this.m_string.substr(this.m_letter,L.length)===L&&(this.m_letter--,this.m_string=c.remove(this.m_string,this.m_letter,this.m_letter+L.length),this.warning(n.MWarning.RECURSIVE_MACRO,L)),N=this.m_string.indexOf(";",this.m_letter)),O=this.getCharNext();for(var w=0;w<P.length;w++)if(P[w].id!==L){if(P[w].id.length<L.length)break}else P.splice(w,1),w--;P.splice(w,0,{id:L,code:this.m_string.substring(y+1,N),args:I}),this.m_string=c.remove(this.m_string,T-1,N),this.m_letter=T-1}}}else this.replaceMacro(P),E=!1}else this.replaceMacro(P),E=!1}else this.replaceMacro(P),E=!1;break;case";":E=!0;break;default:c.isWhitespace(O)||(E=!1)}}}findMetaDescV(t){var e,s,i,h,_,r=new Array;if(h=new RegExp("^#"+t+"(\\s*|\\s+(.*))$","gm"),_=new RegExp("^#"+t+"(\\s*|\\s+(.*))$","m"),s=this.m_string.match(h))for(this.m_string=this.m_string.replace(h,""),e=0;e<s.length;e++)void 0!==(i=s[e].match(_))[2]&&r.push(i[2]);return r}findMetaDescN(t){var e,s,i,h,_,r="";if(h=new RegExp("^#"+t+"(\\s*|\\s+(.*))$","gm"),_=new RegExp("^#"+t+"(\\s*|\\s+(.*))$","m"),s=this.m_string.match(h))for(this.m_string=this.m_string.replace(h,""),e=0;e<s.length;e++)void 0!==(i=s[e].match(_))[2]&&(r+=i[2],e+1<s.length&&(r+="\r\n"));return r}processComment(t){this.m_string=t,this.begin();for(var e=-1;this.m_letter<this.m_string.length;)switch(this.getCharNext()){case"/":"*"===this.getChar()&&(e<0&&(e=this.m_letter-1),this.next());break;case"*":"/"===this.getChar()&&(e>=0?(this.m_string=c.remove(this.m_string,e,this.m_letter),this.m_letter=e,e=-1):this.warning(n.MWarning.UNOPENED_COMMENT,""))}for(e>=0&&this.warning(n.MWarning.UNCLOSED_COMMENT,""),this.begin(),e=-1;this.m_letter<this.m_string.length;)"`"===this.getCharNext()&&(e<0?e=this.m_letter-1:(this.m_string=c.remove(this.m_string,e,this.m_letter-1),this.m_letter=e,e=-1))}processGroupNotes(){var t,e,s,i,h,_,r,a,o,m,c=-1,l=0,p=96;for(this.begin();this.m_letter<this.m_string.length;){var u=this.getCharNext();switch(u){case"l":p=this.len2tick(this.getUInt(0)),p=this.getDot(p);break;case"{":c=this.m_letter-1,l=0;break;case"}":for(e=this.m_letter,c<0&&this.warning(n.MWarning.UNOPENED_GROUPNOTES,""),i=0;;){if("%"!==this.getChar()?o=0:(o=1,this.next()),0===(s=this.getUInt(0))){0===i&&(i=p);break}if(h=o?s:this.len2tick(s),i+=h=this.getDot(h),"&"!==this.getChar())break;this.next()}for(t=this.m_letter,this.m_letter=c+1,m=this.m_string.substring(0,c),h=0,_=i/l,l=1,a=0;this.m_letter<e;){switch(u=this.getCharNext()){case"+":case"#":case"-":break;default:if((u>="a"&&u<="g"||"r"===u)&&0===a){a=1;break}1===a&&(r=Math.round(l*_-h),l++,(h+=r)>i&&(r-=h-i,h=i),m+="%",m+=r.toString()),a=0,(u>="a"&&u<="g"||"r"===u)&&(a=1)}"}"!==u&&(m+=u)}this.m_letter=m.length,m+=this.m_string.substring(t),this.m_string=m,c=-1;break;default:(u>="a"&&u<="g"||"r"===u)&&l++}}c>=0&&this.warning(n.MWarning.UNCLOSED_GROUPNOTES,"")}play(t,e=!1){e?this.play2(t,e):this.m_sequencer.isPaused()?this.m_sequencer.play():(this.worker.onstopsound=()=>{this.play2(t)},this.worker.stopSound())}play2(t,e=!1){this.m_sequencer.disconnectAll(),this.m_tracks=new Array,this.m_tracks[0]=this.createTrack(),this.m_tracks[1]=this.createTrack(),this.m_warning="",this.m_trackNo=o.MTrack.FIRST_TRACK,this.m_octave=4,this.m_relativeDir=!0,this.m_velocity=100,this.m_velDetail=!0,this.m_velDir=!0,this.m_length=this.len2tick(4),this.m_tempo=o.MTrack.DEFAULT_BPM,this.m_keyoff=1,this.m_gate=15,this.m_maxGate=16,this.m_form=s.MOscillator.PULSE,this.m_noteShift=0,this.m_maxPipe=0,this.m_maxSyncSource=0,this.m_beforeNote=0,this.m_portamento=0,this.m_usingPoly=!1,this.m_polyVoice=1,this.m_polyForce=!1,this.m_metaTitle="",this.m_metaArtist="",this.m_metaCoding="",this.m_metaComment="",this.processComment(t),this.processMacro(),this.m_string=c.removeWhitespace(this.m_string),this.processRepeat(),this.processGroupNotes(),this.process(),0===this.m_tracks[this.m_tracks.length-1].getNumEvents()&&this.m_tracks.pop(),this.m_tracks[o.MTrack.TEMPO_TRACK].conduct(this.m_tracks);for(var i=o.MTrack.TEMPO_TRACK;i<this.m_tracks.length;i++)i>o.MTrack.TEMPO_TRACK&&(this.m_usingPoly&&(this.m_polyForce||this.m_tracks[i].findPoly())&&this.m_tracks[i].usingPoly(this.m_polyVoice),this.m_tracks[i].recRestMSec(2e3),this.m_tracks[i].recClose()),this.m_sequencer.connect(this.m_tracks[i]);this.m_sequencer.createPipes(this.m_maxPipe+1),this.m_sequencer.createSyncSources(this.m_maxSyncSource+1),this.worker.compileComplete(),this.m_sequencer.play(e),this.worker.onstopsound=null}stop(){this.m_sequencer.stop()}pause(){this.m_sequencer.pause()}resume(){this.m_sequencer.play()}isPlaying(){return this.m_sequencer.isPlaying()}isPaused(){return this.m_sequencer.isPaused()}getTotalMSec(){return this.m_tracks[o.MTrack.TEMPO_TRACK].getTotalMSec()}getTotalTimeStr(){return this.m_tracks[o.MTrack.TEMPO_TRACK].getTotalTimeStr()}getNowMSec(){return this.m_sequencer.getNowMSec()}getNowTimeStr(){return this.m_sequencer.getNowTimeStr()}getVoiceCount(){var t,e=0;for(t=0;t<this.m_tracks.length;t++)e+=this.m_tracks[t].getVoiceCount();return e}getMetaTitle(){return this.m_metaTitle}getMetaComment(){return this.m_metaComment}getMetaArtist(){return this.m_metaArtist}getMetaCoding(){return this.m_metaCoding}}e.MML=c,c.MAX_PIPE=3,c.MAX_SYNCSOURCE=3,c.MAX_POLYVOICE=64}.apply(e,i))||(t.exports=h)},182:(t,e,s)=>{var i,h;i=[s,e,s(587),s(630)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscFcDpcm=void 0;class h extends i.MOscMod{constructor(){super(),this.m_readCount=0,this.m_address=0,this.m_bit=0,this.m_wav=0,this.m_length=0,this.m_ofs=0,h.boot(),this.setWaveNo(0)}static boot(){this.s_init||(this.s_table=new Array(this.MAX_WAVE),this.s_intVol=new Array(this.MAX_WAVE),this.s_loopFg=new Array(this.MAX_WAVE),this.s_length=new Array(this.MAX_WAVE),this.setWave(0,127,0,""),this.s_init=1)}static setWave(t,e,s,i){this.s_intVol[t]=e,this.s_loopFg[t]=s,this.s_length[t]=0,this.s_table[t]=new Array(this.FC_DPCM_TABLE_MAX_LEN);for(var h=0,_=0,r=0,a=0,o=0;o<this.FC_DPCM_TABLE_MAX_LEN;o++)this.s_table[t][o]=0;for(h=0;h<i.length;h++){var m=i.charCodeAt(h);for(65<=m&&m<=90?m-=65:97<=m&&m<=122?m-=71:48<=m&&m<=57?m-=-4:m=43===m?62:47===m?63:0,o=5;o>=0;o--)this.s_table[t][a]+=(m>>o&1)<<8*_+7-r,++r>=8&&(r=0,_++),this.s_length[t]++,_>=4&&(_=0,++a>=this.FC_DPCM_TABLE_MAX_LEN&&(a=this.FC_DPCM_TABLE_MAX_LEN-1))}this.s_length[t]-=(this.s_length[t]-8)%128,this.s_length[t]>8*this.FC_DPCM_MAX_LEN&&(this.s_length[t]=8*this.FC_DPCM_MAX_LEN),0===this.s_length[t]&&(this.s_length[t]=8)}setWaveNo(t){t>=h.MAX_WAVE&&(t=h.MAX_WAVE-1),h.s_table[t]||(t=0),this.m_waveNo=t}getValue(){return this.m_length>0?(h.s_table[this.m_waveNo][this.m_address]>>this.m_bit&1?this.m_wav<126&&(this.m_wav+=2):this.m_wav>1&&(this.m_wav-=2),this.m_bit++,this.m_bit>=32&&(this.m_bit=0,this.m_address++),this.m_length--,0===this.m_length&&h.s_loopFg[this.m_waveNo]&&(this.m_address=0,this.m_bit=0,this.m_length=h.s_length[this.m_waveNo]),(this.m_wav-64)/64):(this.m_wav-64)/64}resetPhase(){this.m_phase=0,this.m_address=0,this.m_bit=0,this.m_ofs=0,this.m_wav=h.s_intVol[this.m_waveNo],this.m_length=h.s_length[this.m_waveNo]}getNextSample(){var t=(this.m_wav-64)/64;for(this.m_phase=this.m_phase+this.m_freqShift&h.PHASE_MSK;h.FC_DPCM_NEXT<=this.m_phase;)this.m_phase-=h.FC_DPCM_NEXT,this.m_length>0?(h.s_table[this.m_waveNo][this.m_address]>>this.m_bit&1?this.m_wav<126&&(this.m_wav+=2):this.m_wav>1&&(this.m_wav-=2),this.m_bit++,this.m_bit>=32&&(this.m_bit=0,this.m_address++),this.m_length--,0===this.m_length&&h.s_loopFg[this.m_waveNo]&&(this.m_address=0,this.m_bit=0,this.m_length=h.s_length[this.m_waveNo]),t=(this.m_wav-64)/64):t=(this.m_wav-64)/64;return t}getNextSampleOfs(t){var e=(this.m_wav-64)/64;for(this.m_phase=this.m_phase+this.m_freqShift+(t-this.m_ofs>>h.PHASE_SFT-7)&h.PHASE_MSK;h.FC_DPCM_NEXT<=this.m_phase;)this.m_phase-=h.FC_DPCM_NEXT,this.m_length>0?(h.s_table[this.m_waveNo][this.m_address]>>this.m_bit&1?this.m_wav<126&&(this.m_wav+=2):this.m_wav>1&&(this.m_wav-=2),this.m_bit++,this.m_bit>=32&&(this.m_bit=0,this.m_address++),this.m_length--,0===this.m_length&&h.s_loopFg[this.m_waveNo]&&(this.m_address=0,this.m_bit=0,this.m_length=h.s_length[this.m_waveNo]),e=(this.m_wav-64)/64):e=(this.m_wav-64)/64;return this.m_ofs=t,e}getSamples(t,e,s){var i,_=(this.m_wav-64)/64;for(i=e;i<s;i++){for(this.m_phase=this.m_phase+this.m_freqShift&h.PHASE_MSK;h.FC_DPCM_NEXT<=this.m_phase;)this.m_phase-=h.FC_DPCM_NEXT,this.m_length>0?(h.s_table[this.m_waveNo][this.m_address]>>this.m_bit&1?this.m_wav<126&&(this.m_wav+=2):this.m_wav>1&&(this.m_wav-=2),this.m_bit++,this.m_bit>=32&&(this.m_bit=0,this.m_address++),this.m_length--,0===this.m_length&&h.s_loopFg[this.m_waveNo]&&(this.m_address=0,this.m_bit=0,this.m_length=h.s_length[this.m_waveNo]),_=(this.m_wav-64)/64):_=(this.m_wav-64)/64;t[i]=_}}setFrequency(t){this.m_freqShift=t*(1<<h.FC_DPCM_PHASE_SFT+4)|0}setDpcmFreq(t){t<0&&(t=0),t>15&&(t=15),this.m_freqShift=(h.FC_CPU_CYCLE<<h.FC_DPCM_PHASE_SFT)/h.s_interval[t]|0}setNoteNo(t){this.setDpcmFreq(t)}}e.MOscFcDpcm=h,h.MAX_WAVE=16,h.FC_CPU_CYCLE=1789773,h.FC_DPCM_PHASE_SFT=2,h.FC_DPCM_MAX_LEN=4081,h.FC_DPCM_TABLE_MAX_LEN=2+(h.FC_DPCM_MAX_LEN>>2),h.FC_DPCM_NEXT=s.SAMPLE_RATE<<h.FC_DPCM_PHASE_SFT,h.s_interval=[428,380,340,320,286,254,226,214,190,160,142,128,106,85,72,54]}.apply(e,i))||(t.exports=h)},764:(t,e,s)=>{var i,h;i=[s,e,s(587),s(630)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscFcNoise=void 0;class h extends i.MOscMod{constructor(){h.boot(),super(),this.setLongMode(),this.m_fcr=32768,this.m_val=this.getValue(),this.setNoiseFreq(0)}getValue(){return this.m_fcr>>=1,this.m_fcr|=(1&(this.m_fcr^this.m_fcr>>this.m_snz))<<15,1&this.m_fcr?1:-1}setShortMode(){this.m_snz=6}setLongMode(){this.m_snz=1}resetPhase(){}addPhase(t){for(this.m_phase=this.m_phase+h.FC_NOISE_PHASE_DLT*t|0;this.m_phase>=this.m_freqShift;)this.m_phase-=this.m_freqShift,this.m_val=this.getValue()}static boot(){}getNextSample(){for(var t=this.m_val,e=0,s=0,i=h.FC_NOISE_PHASE_DLT;i>=this.m_freqShift;)i-=this.m_freqShift,this.m_phase=0,e+=this.getValue(),s+=1;return s>0&&(this.m_val=e/s),this.m_phase=this.m_phase+i|0,this.m_phase>=this.m_freqShift&&(this.m_phase-=this.m_freqShift,this.m_val=this.getValue()),t}getNextSampleOfs(t){for(var e=this.m_fcr,s=this.m_phase,i=this.m_val,_=0,r=0,a=h.FC_NOISE_PHASE_DLT+t;a>=this.m_freqShift;)a-=this.m_freqShift,this.m_phase=0,_+=this.getValue(),r+=1;return r>0&&(this.m_val=_/r),this.m_phase=this.m_phase+a|0,this.m_phase>=this.m_freqShift&&(this.m_phase=this.m_freqShift,this.m_val=this.getValue()),this.m_fcr=e,this.m_phase=s,this.getNextSample(),i}getSamples(t,e,s){for(var i=e;i<s;i++)t[i]=this.getNextSample()}setFrequency(t){this.m_freqShift=h.FC_NOISE_PHASE_SEC/t|0}setNoiseFreq(t){t<0&&(t=0),t>15&&(t=15),this.m_freqShift=h.s_interval[t]<<h.FC_NOISE_PHASE_SFT|0}setNoteNo(t){this.setNoiseFreq(t)}}e.MOscFcNoise=h,h.FC_NOISE_PHASE_SFT=10,h.FC_NOISE_PHASE_SEC=1789773<<h.FC_NOISE_PHASE_SFT|0,h.FC_NOISE_PHASE_DLT=h.FC_NOISE_PHASE_SEC/s.SAMPLE_RATE|0,h.s_interval=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068]}.apply(e,i))||(t.exports=h)},806:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscFcTri=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){if(!this.s_init){var t;for(this.s_table=new Array(this.MAX_WAVE),this.s_table[0]=new Array(this.FC_TRI_TABLE_LEN),this.s_table[1]=new Array(this.FC_TRI_TABLE_LEN),t=0;t<16;t++)this.s_table[0][t]=this.s_table[0][31-t]=2*t/15-1;for(t=0;t<32;t++)this.s_table[1][t]=t<8?2*t/14:t<24?2*(8-t)/15+1:2*(t-24)/15-1;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][(this.m_phase+t&i.PHASE_MSK)>>i.PHASE_SFT+11];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;for(_=s;_<h;_++)t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}setWaveNo(t){this.m_waveNo=Math.min(t,i.MAX_WAVE-1)}}e.MOscFcTri=i,i.FC_TRI_TABLE_LEN=32,i.MAX_WAVE=2,i.s_init=0}.apply(e,i))||(t.exports=h)},579:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscGbLNoise=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.m_sum=0,this.m_skip=0}static boot(){if(!this.s_init){for(var t=65535,e=1,s=0;s<this.GB_NOISE_TABLE_LEN;s++)0===t&&(t=1),e^=1&(t+=t+(1&(t>>14^t>>13))|0),this.s_table[s]=2*e-1;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT];this.m_skip>0&&(t=(t+this.m_sum)/(this.m_skip+1)),this.m_sum=0,this.m_skip=0;for(var e=this.m_freqShift;e>i.GB_NOISE_PHASE_DLT;)this.m_phase=(this.m_phase+i.GB_NOISE_PHASE_DLT)%i.GB_NOISE_TABLE_MOD,e-=i.GB_NOISE_PHASE_DLT,this.m_sum+=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip++;return this.m_phase=(this.m_phase+e)%i.GB_NOISE_TABLE_MOD,t}getNextSampleOfs(t){var e=(this.m_phase+t)%i.GB_NOISE_TABLE_MOD,s=i.s_table[e+(e>>31&i.GB_NOISE_TABLE_MOD)>>i.GB_NOISE_PHASE_SFT];return this.m_phase=(this.m_phase+this.m_freqShift)%i.GB_NOISE_TABLE_MOD,s}getSamples(t,e,s){var h,_;for(h=e;h<s;h++){_=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip>0&&(_=(_+this.m_sum)/(this.m_skip+1)),t[h]=_,this.m_sum=0,this.m_skip=0;for(var r=this.m_freqShift;r>i.GB_NOISE_PHASE_DLT;)this.m_phase=(this.m_phase+i.GB_NOISE_PHASE_DLT)%i.GB_NOISE_TABLE_MOD,r-=i.GB_NOISE_PHASE_DLT,this.m_sum+=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip++;this.m_phase=(this.m_phase+r)%i.GB_NOISE_TABLE_MOD}}setFrequency(t){this.m_frequency=t}setNoiseFreq(t){t<0&&(t=0),t>63&&(t=63),this.m_freqShift=(1048576<<i.GB_NOISE_PHASE_SFT-2)/(11025*i.s_interval[t])|0}setNoteNo(t){this.setNoiseFreq(t)}}e.MOscGbLNoise=i,i.GB_NOISE_PHASE_SFT=12,i.GB_NOISE_PHASE_DLT=1<<i.GB_NOISE_PHASE_SFT,i.GB_NOISE_TABLE_LEN=32767,i.GB_NOISE_TABLE_MOD=(i.GB_NOISE_TABLE_LEN<<i.GB_NOISE_PHASE_SFT)-1,i.s_init=0,i.s_table=new Array(i.GB_NOISE_TABLE_LEN),i.s_interval=[2,4,8,12,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,640,768,896,1024,1280,1536,1792,2048,2560,3072,3584,4096,5120,6144,7168,8192,10240,12288,14336,16384,20480,24576,28672,32768,40960,49152,57344,65536,81920,98304,114688,131072,163840,196608,229376,262144,327680,393216,458752]}.apply(e,i))||(t.exports=h)},346:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscGbSNoise=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.m_sum=0,this.m_skip=0}static boot(){if(!this.s_init){for(var t=65535,e=1,s=0;s<this.GB_NOISE_TABLE_LEN;s++)0===t&&(t=1),e^=1&(t+=t+(1&(t>>6^t>>5))|0),this.s_table[s]=2*e-1;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT];this.m_skip>0&&(t=(t+this.m_sum)/Number(this.m_skip+1)),this.m_sum=0,this.m_skip=0;for(var e=this.m_freqShift;e>i.GB_NOISE_PHASE_DLT;)this.m_phase=(this.m_phase+i.GB_NOISE_PHASE_DLT)%i.GB_NOISE_TABLE_MOD,e-=i.GB_NOISE_PHASE_DLT,this.m_sum+=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip++;return this.m_phase=(this.m_phase+e)%i.GB_NOISE_TABLE_MOD,t}getNextSampleOfs(t){var e=(this.m_phase+t)%i.GB_NOISE_TABLE_MOD,s=i.s_table[e+(e>>31&i.GB_NOISE_TABLE_MOD)>>i.GB_NOISE_PHASE_SFT];return this.m_phase=(this.m_phase+this.m_freqShift)%i.GB_NOISE_TABLE_MOD,s}getSamples(t,e,s){var h,_;for(h=e;h<s;h++){_=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip>0&&(_=(_+this.m_sum)/Number(this.m_skip+1)),t[h]=_,this.m_sum=0,this.m_skip=0;for(var r=this.m_freqShift;r>i.GB_NOISE_PHASE_DLT;)this.m_phase=(this.m_phase+i.GB_NOISE_PHASE_DLT)%i.GB_NOISE_TABLE_MOD,r-=i.GB_NOISE_PHASE_DLT,this.m_sum+=i.s_table[this.m_phase>>i.GB_NOISE_PHASE_SFT],this.m_skip++;this.m_phase=(this.m_phase+r)%i.GB_NOISE_TABLE_MOD}}setFrequency(t){this.m_frequency=t}setNoiseFreq(t){t<0&&(t=0),t>63&&(t=63),this.m_freqShift=(1048576<<i.GB_NOISE_PHASE_SFT-2)/(11025*i.s_interval[t])}setNoteNo(t){this.setNoiseFreq(t)}}e.MOscGbSNoise=i,i.GB_NOISE_PHASE_SFT=12,i.GB_NOISE_PHASE_DLT=1<<i.GB_NOISE_PHASE_SFT,i.GB_NOISE_TABLE_LEN=127,i.GB_NOISE_TABLE_MOD=(i.GB_NOISE_TABLE_LEN<<i.GB_NOISE_PHASE_SFT)-1,i.s_init=0,i.s_table=new Array(i.GB_NOISE_TABLE_LEN),i.s_interval=[2,4,8,12,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,256,320,384,448,512,640,768,896,1024,1280,1536,1792,2048,2560,3072,3584,4096,5120,6144,7168,8192,10240,12288,14336,16384,20480,24576,28672,32768,40960,49152,57344,65536,81920,98304,114688,131072,163840,196608,229376,262144,327680,393216,458752]}.apply(e,i))||(t.exports=h)},691:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscGbWave=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){this.s_init||(this.s_table=new Array(this.MAX_WAVE),this.setWave(0,"0123456789abcdeffedcba9876543210"),this.s_init=1)}static setWave(t,e){this.s_table[t]=new Array(this.GB_WAVE_TABLE_LEN);for(var s=0;s<32;s++){var i=e.charCodeAt(s);48<=i&&i<58?i-=48:97<=i&&i<103?i-=87:i=0,this.s_table[t][s]=(i-7.5)/7.5}}setWaveNo(t){t>=i.MAX_WAVE&&(t=i.MAX_WAVE-1),i.s_table[t]||(t=0),this.m_waveNo=t}getNextSample(){var t=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][(this.m_phase+t&i.PHASE_MSK)>>i.PHASE_SFT+11];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;for(_=s;_<h;_++)t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT+11],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}}e.MOscGbWave=i,i.MAX_WAVE=32,i.GB_WAVE_TABLE_LEN=32,i.s_init=0}.apply(e,i))||(t.exports=h)},630:(t,e,s)=>{var i,h;i=[s,e,s(587)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscMod=void 0;class i{constructor(){this.resetPhase(),this.setFrequency(440)}resetPhase(){this.m_phase=0}addPhase(t){this.m_phase=this.m_phase+this.m_freqShift*t&i.PHASE_MSK}getNextSample(){return 0}getNextSampleOfs(t){return 0}getSamples(t,e,s){}getSamplesWithSyncIn(t,e,s,i){this.getSamples(t,s,i)}getSamplesWithSyncOut(t,e,s,i){this.getSamples(t,s,i)}getFrequency(){return this.m_frequency}setFrequency(t){this.m_frequency=t,this.m_freqShift=t*(i.PHASE_LEN/s.SAMPLE_RATE)|0}setWaveNo(t){}setNoteNo(t){}}e.MOscMod=i,i.TABLE_LEN=65536,i.PHASE_SFT=14,i.PHASE_LEN=i.TABLE_LEN<<i.PHASE_SFT,i.PHASE_HLF=i.TABLE_LEN<<i.PHASE_SFT-1,i.PHASE_MSK=i.PHASE_LEN-1}.apply(e,i))||(t.exports=h)},650:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscNoise=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setNoiseFreq(1),this.m_phase=0,this.m_counter=0,this.m_resetPhase=!0}disableResetPhase(){this.m_resetPhase=!1}static boot(){if(!this.s_init){for(var t=0;t<this.TABLE_LEN;t++)this.s_table[t]=2*Math.random()-1;this.s_init=1}}resetPhase(){this.m_resetPhase&&(this.m_phase=0)}addPhase(t){this.m_counter=this.m_counter+this.m_freqShift*t,this.m_phase=this.m_phase+(this.m_counter>>i.NOISE_PHASE_SFT)&i.TABLE_MSK,this.m_counter&=i.NOISE_PHASE_MSK}getNextSample(){var t=i.s_table[this.m_phase];return this.m_counter=this.m_counter+this.m_freqShift,this.m_phase=this.m_phase+(this.m_counter>>i.NOISE_PHASE_SFT)&i.TABLE_MSK,this.m_counter&=i.NOISE_PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_phase+(t<<i.PHASE_SFT)&i.TABLE_MSK];return this.m_counter=this.m_counter+this.m_freqShift,this.m_phase=this.m_phase+(this.m_counter>>i.NOISE_PHASE_SFT)&i.TABLE_MSK,this.m_counter&=i.NOISE_PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_phase],this.m_counter=this.m_counter+this.m_freqShift,this.m_phase=this.m_phase+(this.m_counter>>i.NOISE_PHASE_SFT)&i.TABLE_MSK,this.m_counter&=i.NOISE_PHASE_MSK}setFrequency(t){this.m_frequency=t}setNoiseFreq(t){this.m_noiseFreq=t*(1<<i.NOISE_PHASE_SFT),this.m_freqShift=this.m_noiseFreq}restoreFreq(){this.m_freqShift=this.m_noiseFreq}}e.MOscNoise=i,i.TABLE_MSK=i.TABLE_LEN-1,i.NOISE_PHASE_SFT=30,i.NOISE_PHASE_MSK=(1<<i.NOISE_PHASE_SFT)-1,i.s_init=0,i.s_table=new Array(i.TABLE_LEN)}.apply(e,i))||(t.exports=h)},437:(t,e,s)=>{var i,h;i=[s,e,s(587),s(630),s(750)],void 0===(h=function(t,e,s,i,h){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscOPM=void 0;class _ extends i.MOscMod{constructor(){super(),this.m_fm=new h.OPM,this.m_oneSample=new Float32Array(1),this.m_velocity=127,this.m_al=0,this.m_tl=new Array(4),this.m_frequency=0,_.boot(),this.m_fm.Init(_.OPM_CLOCK,s.SAMPLE_RATE),this.m_fm.Reset(),this.m_fm.SetVolume(_.s_comGain),this.setOpMask(15),this.setWaveNo(0)}static boot(){0===this.s_init&&(this.s_table[0]=this.defTimbre,this.s_init=1)}static clearTimber(){for(var t=0;t<this.s_table.length;t++)this.s_table[t]=0===t?this.defTimbre:null}static trim(t){return t.replace(/^[,]*/m,"").replace(/[,]*$/m,"")}static setTimber(t,e,s){if(!(t<0||this.MAX_WAVE<=t)){s=s.replace(/[,;\s\t\r\n]+/gm,",");var i,h,_,r=(s=this.trim(s)).split(","),a=new Array(this.TIMB_SZ_M);switch(e){case this.TYPE_OPM:if(r.length<46)return;break;case this.TYPE_OPN:if(r.length<42)return;break;default:return}switch(e){case this.TYPE_OPM:for(_=Math.min(this.TIMB_SZ_M,r.length),i=0;i<_;i++)a[i]=0|r[i];for(;i<this.TIMB_SZ_M;i++)a[i]=this.zeroTimbre[i];break;case this.TYPE_OPN:for(i=0,h=0;i<2;i++,h++)a[i]=0|r[h];for(;i<46;i++)a[i]=(i-2)%11==9?0:0|r[h++];for(_=Math.min(this.TIMB_SZ_N,r.length);h<_;i++,h++)a[i]=0|r[h];for(;i<this.TIMB_SZ_M;i++)a[i]=this.zeroTimbre[i]}this.s_table[t]=a}}loadTimbre(t){var e,s;this.SetFBAL(t[1],t[0]);var i=_.slottable;for(e=2,s=0;s<4;s++,e+=11)this.SetDT1ML(i[s],t[e+8],t[e+7]),this.m_tl[s]=t[e+5],this.SetTL(i[s],t[e+5]),this.SetKSAR(i[s],t[e+6],t[e+0]),this.SetDRAMS(i[s],t[e+1],t[e+10]),this.SetDT2SR(i[s],t[e+9],t[e+2]),this.SetSLRR(i[s],t[e+4],t[e+3]);this.setVelocity(this.m_velocity),this.setOpMask(t[e+0]),this.setWF(t[e+1]),this.setLFRQ(t[e+2]),this.setPMD(t[e+3]),this.setAMD(t[e+4]),this.setPMSAMS(t[e+5],t[e+6]),this.setNENFRQ(t[e+7],t[e+8])}static setCommonGain(t){this.s_comGain=t}SetFBAL(t,e){this.m_al=7&e,this.m_fm.SetReg(32,192|(7&t)<<3|7&e)}SetDT1ML(t,e,s){this.m_fm.SetReg(64|(3&t)<<3,(7&e)<<4|15&s)}SetTL(t,e){e<0&&(e=0),e>127&&(e=127),this.m_fm.SetReg(96|(3&t)<<3,127&e)}SetKSAR(t,e,s){this.m_fm.SetReg(128|(3&t)<<3,(3&e)<<6|31&s)}SetDRAMS(t,e,s){this.m_fm.SetReg(160|(3&t)<<3,(1&s)<<7|31&e)}SetDT2SR(t,e,s){this.m_fm.SetReg(192|(3&t)<<3,(3&e)<<6|31&s)}SetSLRR(t,e,s){this.m_fm.SetReg(224|(3&t)<<3,(15&e)<<4|15&s)}setPMSAMS(t,e){this.m_fm.SetReg(56,(7&t)<<4|3&e)}setPMD(t){this.m_fm.SetReg(25,128|127&t)}setAMD(t){this.m_fm.SetReg(25,0|127&t)}setNENFRQ(t,e){this.m_fm.SetReg(15,(1&t)<<7|31&e)}setLFRQ(t){this.m_fm.SetReg(24,255&t)}setWF(t){this.m_fm.SetReg(27,3&t)}noteOn(){this.m_fm.SetReg(1,2),this.m_fm.SetReg(1,0),this.m_fm.SetReg(8,this.m_opMask<<3)}noteOff(){this.m_fm.SetReg(8,0)}setWaveNo(t){t>=_.MAX_WAVE&&(t=_.MAX_WAVE-1),null==_.s_table[t]&&(t=0),this.m_fm.SetVolume(_.s_comGain),this.loadTimbre(_.s_table[t])}setNoteNo(t){this.noteOn()}setOpMask(t){this.m_opMask=15&t}setVelocity(t){this.m_velocity=t;var e=this.m_al,s=this.m_tl,i=_.carrierop[e],h=_.slottable;this.SetTL(h[0],s[0]+(8&i?127-t:0)),this.SetTL(h[1],s[1]+(16&i?127-t:0)),this.SetTL(h[2],s[2]+(32&i?127-t:0)),this.SetTL(h[3],s[3]+(64&i?127-t:0))}setExpression(t){this.m_fm.SetExpression(t)}setFrequency(t){if(this.m_frequency!==t&&(super.setFrequency(t),this.m_fm)){var e=1200*Math.log(t/440)*Math.LOG2E+5700+_.OPM_RATIO+.5|0,s=e/100|0,i=e%100*64/100+.5|0,h=(s-1)/12<<4|_.kctable[(s+1200)%12];this.m_fm.SetReg(48,i<<2),this.m_fm.SetReg(40,h)}}getNextSample(){return this.m_fm.Mix(this.m_oneSample,0,1),this.m_oneSample[0]}getNextSampleOfs(t){return this.m_fm.Mix(this.m_oneSample,0,1),this.m_oneSample[0]}getSamples(t,e,s){this.m_fm.Mix(t,e,s-e)}IsPlaying(){return this.m_fm.IsOn(0)}}e.MOscOPM=_,_.MAX_WAVE=128,_.OPM_CLOCK=358e4,_.OPM_RATIO=0,_.TIMB_SZ_M=55,_.TIMB_SZ_N=51,_.TYPE_OPM=0,_.TYPE_OPN=1,_.s_init=0,_.s_table=new Array(_.MAX_WAVE),_.s_comGain=14.25,_.kctable=[14,0,1,2,4,5,6,8,9,10,12,13],_.slottable=[0,2,1,3],_.carrierop=[64,64,64,64,80,112,112,120],_.defTimbre=[4,5,31,5,0,0,0,23,1,1,3,0,0,20,10,3,7,8,0,1,1,3,0,0,31,3,0,0,0,25,1,1,7,0,0,31,12,3,7,10,2,1,1,7,0,0,15,0,0,0,0,0,0,0,0],_.zeroTimbre=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,15,0,0,0,0,0,0,0,0]}.apply(e,i))||(t.exports=h)},455:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscPulse=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setPWM(.5),this.setMIX(0)}static boot(){}getNextSample(){var t=this.m_phase<this.m_pwm?1:this.m_mix?this.m_modNoise.getNextSample():-1;return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=(this.m_phase+t&i.PHASE_MSK)<this.m_pwm?1:this.m_mix?this.m_modNoise.getNextSampleOfs(t):-1;return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;if(this.m_mix)for(h=e;h<s;h++)t[h]=this.m_phase<this.m_pwm?1:this.m_modNoise.getNextSample(),this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK;else for(h=e;h<s;h++)t[h]=this.m_phase<this.m_pwm?1:-1,this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;if(this.m_mix)for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=this.m_phase<this.m_pwm?1:this.m_modNoise.getNextSample(),this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK;else for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=this.m_phase<this.m_pwm?1:-1,this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;if(this.m_mix)for(_=s;_<h;_++)t[_]=this.m_phase<this.m_pwm?1:this.m_modNoise.getNextSample(),this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK;else for(_=s;_<h;_++)t[_]=this.m_phase<this.m_pwm?1:-1,this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}setPWM(t){this.m_pwm=t*i.PHASE_LEN}setMIX(t){this.m_mix=t}setNoise(t){this.m_modNoise=t}}e.MOscPulse=i}.apply(e,i))||(t.exports=h)},151:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscSaw=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){if(!this.s_init){var t,e,s=1/this.TABLE_LEN;for(this.s_table=new Array(this.MAX_WAVE),e=0;e<this.MAX_WAVE;e++)this.s_table[e]=new Array(this.TABLE_LEN);for(e=0,t=0;e<this.TABLE_LEN;e++)this.s_table[0][e]=2*t-1,this.s_table[1][e]=t<.5?2*t:2*t-2,t+=s;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][(this.m_phase+t&i.PHASE_MSK)>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;for(_=s;_<h;_++)t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}setWaveNo(t){this.m_waveNo=Math.min(t,i.MAX_WAVE-1)}}e.MOscSaw=i,i.MAX_WAVE=2,i.s_init=0}.apply(e,i))||(t.exports=h)},694:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscSine=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){if(!this.s_init){var t,e,s=2*Math.PI/this.TABLE_LEN;for(e=0;e<this.MAX_WAVE;e++)this.s_table[e]=new Array(this.TABLE_LEN);for(e=0,t=0;e<this.TABLE_LEN;e++)this.s_table[0][e]=Math.sin(t),this.s_table[1][e]=Math.max(0,this.s_table[0][e]),this.s_table[2][e]=this.s_table[0][e]>=0?this.s_table[0][e]:-1*this.s_table[0][e],t+=s;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][(this.m_phase+t&i.PHASE_MSK)>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h,_=i.s_table[this.m_waveNo];for(h=e;h<s;h++)t[h]=_[this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _,r=i.s_table[this.m_waveNo];for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=r[this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _,r=i.s_table[this.m_waveNo];for(_=s;_<h;_++)t[_]=r[this.m_phase>>i.PHASE_SFT],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}setWaveNo(t){t>=i.MAX_WAVE&&(t=i.MAX_WAVE-1),i.s_table[t]||(t=0),this.m_waveNo=t}}e.MOscSine=i,i.MAX_WAVE=3,i.s_init=0,i.s_table=new Array(i.MAX_WAVE)}.apply(e,i))||(t.exports=h)},59:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscTriangle=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){if(!this.s_init){var t,e,s=1/this.TABLE_LEN;for(this.s_table=new Array(this.MAX_WAVE),e=0;e<this.MAX_WAVE;e++)this.s_table[e]=new Array(this.TABLE_LEN);for(e=0,t=0;e<this.TABLE_LEN;e++)this.s_table[0][e]=t<.5?1-4*t:1-4*(1-t),this.s_table[1][e]=t<.25?0-4*t:t<.75?4*t-2:4-4*t,t+=s;this.s_init=1}}getNextSample(){var t=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][(this.m_phase+t&i.PHASE_MSK)>>i.PHASE_SFT];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;for(_=s;_<h;_++)t[_]=i.s_table[this.m_waveNo][this.m_phase>>i.PHASE_SFT],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}setWaveNo(t){this.m_waveNo=Math.min(t,i.MAX_WAVE-1)}}e.MOscTriangle=i,i.MAX_WAVE=2,i.s_init=0}.apply(e,i))||(t.exports=h)},982:(t,e,s)=>{var i,h;i=[s,e,s(630)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscWave=void 0;class i extends s.MOscMod{constructor(){i.boot(),super(),this.setWaveNo(0)}static boot(){this.s_init||(this.s_table=new Array(this.MAX_WAVE),this.s_length=new Array(this.MAX_WAVE),this.setWave(0,"00112233445566778899AABBCCDDEEFFFFEEDDCCBBAA99887766554433221100"),this.s_init=1)}static setWave(t,e){this.s_length[t]=0,this.s_table[t]=new Array(e.length/2|0),this.s_table[t][0]=0;for(var s=0,i=0,h=0;s<this.MAX_LENGTH&&s<e.length;s++,i++){var _=e.charCodeAt(s);48<=_&&_<58?_-=48:97<=_&&_<103?_-=87:_=0,1&i?(h+=_,this.s_table[t][this.s_length[t]]=(Number(h)-127.5)/127.5,this.s_length[t]++):h=_<<4}0===this.s_length[t]&&(this.s_length[t]=1),this.s_length[t]=(this.PHASE_MSK+1)/this.s_length[t]}setWaveNo(t){t>=i.MAX_WAVE&&(t=i.MAX_WAVE-1),i.s_table[t]||(t=0),this.m_waveNo=t}getNextSample(){var t=i.s_table[this.m_waveNo][Math.floor(this.m_phase/i.s_length[this.m_waveNo])];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,t}getNextSampleOfs(t){var e=i.s_table[this.m_waveNo][Math.floor((this.m_phase+t&i.PHASE_MSK)/i.s_length[this.m_waveNo])];return this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK,e}getSamples(t,e,s){var h;for(h=e;h<s;h++)t[h]=i.s_table[this.m_waveNo][Math.floor(this.m_phase/i.s_length[this.m_waveNo])],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncIn(t,e,s,h){var _;for(_=s;_<h;_++)e[_]&&this.resetPhase(),t[_]=i.s_table[this.m_waveNo][Math.floor(this.m_phase/i.s_length[this.m_waveNo])],this.m_phase=this.m_phase+this.m_freqShift&i.PHASE_MSK}getSamplesWithSyncOut(t,e,s,h){var _;for(_=s;_<h;_++)t[_]=i.s_table[this.m_waveNo][Math.floor(this.m_phase/i.s_length[this.m_waveNo])],this.m_phase+=this.m_freqShift,e[_]=this.m_phase>i.PHASE_MSK,this.m_phase&=i.PHASE_MSK}}e.MOscWave=i,i.MAX_WAVE=32,i.MAX_LENGTH=2048,i.s_init=0}.apply(e,i))||(t.exports=h)},777:(t,e,s)=>{var i,h;i=[s,e,s(694),s(151),s(59),s(650),s(455),s(806),s(764),s(182),s(691),s(579),s(346),s(437),s(982)],void 0===(h=function(t,e,s,i,h,_,r,a,o,m,n,c,l,p,u){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MOscillator=void 0;class g{constructor(){g.boot(),this.m_osc=new Array(g.MAX),this.m_osc[g.SINE]=new s.MOscSine,this.m_osc[g.SAW]=new i.MOscSaw,this.m_osc[g.TRIANGLE]=new h.MOscTriangle,this.m_osc[g.PULSE]=new r.MOscPulse,this.m_osc[g.NOISE]=new _.MOscNoise,this.m_osc[g.FC_PULSE]=new r.MOscPulse,this.m_osc[g.FC_TRI]=new a.MOscFcTri,this.m_osc[g.FC_NOISE]=new o.MOscFcNoise,this.m_osc[g.FC_S_NOISE]=null,this.m_osc[g.FC_DPCM]=new m.MOscFcDpcm,this.m_osc[g.GB_WAVE]=new n.MOscGbWave,this.m_osc[g.GB_NOISE]=new c.MOscGbLNoise,this.m_osc[g.GB_S_NOISE]=new l.MOscGbSNoise,this.m_osc[g.WAVE]=new u.MOscWave,this.m_osc[g.OPM]=new p.MOscOPM,this.setForm(g.PULSE),this.setNoiseToPulse()}asLFO(){this.m_osc[g.NOISE]&&this.m_osc[g.NOISE].disableResetPhase()}static boot(){this.s_init||(s.MOscSine.boot(),i.MOscSaw.boot(),h.MOscTriangle.boot(),r.MOscPulse.boot(),_.MOscNoise.boot(),a.MOscFcTri.boot(),o.MOscFcNoise.boot(),m.MOscFcDpcm.boot(),n.MOscGbWave.boot(),c.MOscGbLNoise.boot(),l.MOscGbSNoise.boot(),u.MOscWave.boot(),p.MOscOPM.boot(),this.s_init=1)}setForm(t){switch(t>=g.MAX&&(t=g.MAX-1),this.m_form=t,t){case g.NOISE:this.m_osc[g.NOISE].restoreFreq();break;case g.FC_NOISE:this.getMod(g.FC_NOISE).setLongMode();break;case g.FC_S_NOISE:this.getMod(g.FC_S_NOISE).setShortMode()}return this.getMod(t)}getForm(){return this.m_form}getCurrent(){return this.getMod(this.m_form)}getMod(t){return t!==g.FC_S_NOISE?this.m_osc[t]:this.m_osc[g.FC_NOISE]}setNoiseToPulse(){var t=this.getMod(g.PULSE),e=this.getMod(g.NOISE);t.setNoise(e)}}e.MOscillator=g,g.SINE=0,g.SAW=1,g.TRIANGLE=2,g.PULSE=3,g.NOISE=4,g.FC_PULSE=5,g.FC_TRI=6,g.FC_NOISE=7,g.FC_S_NOISE=8,g.FC_DPCM=9,g.GB_WAVE=10,g.GB_NOISE=11,g.GB_S_NOISE=12,g.WAVE=13,g.OPM=14,g.MAX=15,g.s_init=0}.apply(e,i))||(t.exports=h)},949:(t,e,s)=>{var i,h;i=[s,e,s(870),s(777)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MPolyChannel=void 0,e.MPolyChannel=class{constructor(t){this.m_voices=new Array(t);for(var e=0;e<this.m_voices.length;e++)this.m_voices[e]=new s.MChannel;this.m_form=i.MOscillator.FC_PULSE,this.m_subform=0,this.m_voiceId=0,this.m_volMode=0,this.m_voiceLimit=t,this.m_lastVoice=null,this.m_voiceLen=this.m_voices.length}setExpression(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setExpression(t)}setVelocity(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setVelocity(t)}setNoteNo(t,e=!0){null!==this.m_lastVoice&&this.m_lastVoice.isPlaying()&&this.m_lastVoice.setNoteNo(t,e)}setDetune(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setDetune(t)}getVoiceCount(){var t,e=0;for(t=0;t<this.m_voiceLen;t++)e+=this.m_voices[t].getVoiceCount();return e}noteOn(t,e){var s,i=null;if(this.getVoiceCount()<=this.m_voiceLimit)for(s=0;s<this.m_voiceLen;s++)if(!1===this.m_voices[s].isPlaying()){i=this.m_voices[s];break}if(null==i){var h=Number.MAX_VALUE;for(s=0;s<this.m_voiceLen;s++)h>this.m_voices[s].getId()&&(h=this.m_voices[s].getId(),i=this.m_voices[s])}i.setForm(this.m_form,this.m_subform),i.setVolMode(this.m_volMode),i.noteOnWidthId(t,e,this.m_voiceId++),this.m_lastVoice=i}noteOff(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].getNoteNo()===t&&this.m_voices[e].noteOff(t)}setSoundOff(){for(var t=0;t<this.m_voiceLen;t++)this.m_voices[t].setSoundOff()}close(){for(var t=0;t<this.m_voiceLen;t++)this.m_voices[t].close()}setNoiseFreq(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setNoiseFreq(t)}setForm(t,e){this.m_form=t,this.m_subform=e}setEnvelope1Atk(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setEnvelope1Atk(t)}setEnvelope1Point(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setEnvelope1Point(t,e)}setEnvelope1Rel(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setEnvelope1Rel(t)}setEnvelope2Atk(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setEnvelope2Atk(t)}setEnvelope2Point(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setEnvelope2Point(t,e)}setEnvelope2Rel(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setEnvelope2Rel(t)}setPWM(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setPWM(t)}setPan(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setPan(t)}setFormant(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setFormant(t)}setLFOFMSF(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setLFOFMSF(t,e)}setLFODPWD(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setLFODPWD(t,e)}setLFODLTM(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setLFODLTM(t,e)}setLFOTarget(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setLFOTarget(t)}setLpfSwtAmt(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setLpfSwtAmt(t,e)}setLpfFrqRes(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setLpfFrqRes(t,e)}setVolMode(t){this.m_volMode=t}setInput(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setInput(t,e)}setOutput(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setOutput(t,e)}setRing(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setRing(t,e)}setSync(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setSync(t,e)}setPortamento(t,e){for(var s=0;s<this.m_voiceLen;s++)this.m_voices[s].setPortamento(t,e)}setMidiPort(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setMidiPort(t)}setMidiPortRate(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setMidiPortRate(t)}setPortBase(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setPortBase(t)}setVoiceLimit(t){this.m_voiceLimit=Math.max(1,Math.min(t,this.m_voiceLen))}setHwLfo(t){for(var e=0;e<this.m_voiceLen;e++)this.m_voices[e].setHwLfo(t)}reset(){this.m_form=0,this.m_subform=0,this.m_voiceId=0,this.m_volMode=0;for(var t=0;t<this.m_voiceLen;t++)this.m_voices[t].reset()}getSamples(t,e,s,i){for(var h=!1,_=0;_<this.m_voiceLen;_++)this.m_voices[_].isPlaying()&&(this.m_voices[_].setSlaveVoice(h),this.m_voices[_].getSamples(t,e,s,i),h=!0);!1===h&&this.m_voices[0].clearOutPipe(e,s,i)}}}.apply(e,i))||(t.exports=h)},234:(t,e,s)=>{var i,h;i=[s,e,s(587),s(777),s(870),s(721),s(150)],void 0===(h=function(t,e,s,i,h,_,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MSequencer=void 0;class a{constructor(t){this.worker=t,this.bufferSize=t.bufferSize,this.bufferMultiple=t.bufferMultiple;var e=this.bufferSize*this.bufferMultiple;h.MChannel.boot(e),i.MOscillator.boot(),_.MEnvelope.boot(),this.m_trackArr=new Array,this.m_playSide=1,this.m_playSize=0,this.m_step=0,this.m_buffer=[[new Float32Array(e),new Float32Array(e)],[new Float32Array(e),new Float32Array(e)]],this.m_maxProcTime=this.bufferSize/s.SAMPLE_RATE*1e3*.8,this.processAllBinded=()=>{this.processAll()},this.worker.onrequestbuffer=t=>{this.onSampleData(t)},this.stop()}static getTimer(){return self.performance?self.performance.now():(new Date).getTime()}play(t=!1){if(1===this.m_status)this.m_status=3,this.worker.playSound(),this.startProcTimer();else{this.m_globalSample=0,this.m_totalMSec=this.getTotalMSec();for(var e=0;e<this.m_trackArr.length;e++)this.m_trackArr[e].seekTop();this.m_maxNowMSec=0,this.m_status=2,this.isExportingAudio=t,this.processStart()}this.m_lastTime=0,this.m_waitPause=!1,this.bufferId=1,this.worker.infoInterval>0&&this.worker.restartInfoTimer()}stop(){clearTimeout(this.m_procTimer),this.worker.stopSound(),this.m_status=0,this.m_lastTime=0,this.m_maxNowMSec=0,this.m_waitPause=!1}pause(){if(!this.isExportingAudio)switch(this.m_status){case 2:this.m_waitPause=!0;break;case 3:this.worker.stopSound(),this.m_status=1,this.m_waitPause&&(this.worker.syncInfo(),this.m_waitPause=!1)}}disconnectAll(){for(;this.m_trackArr.pop(););this.m_status=0}connect(t){this.m_trackArr.push(t)}reqBuffering(){this.m_buffTimer||(this.m_buffTimer=self.setTimeout((()=>{this.onBufferingReq()}),0))}onBufferingReq(){this.m_status=2,this.startProcTimer(),this.m_buffTimer=0}startProcTimer(t=0){clearTimeout(this.m_procTimer),0!==this.m_status&&(this.m_procTimer=self.setTimeout(this.processAllBinded,t))}processStart(){this.m_step=1,this.startProcTimer()}processAll(){var t=this.m_buffer[1-this.m_playSide],e=this.bufferSize,s=e*this.bufferMultiple,i=Math.min(4*e,s),h=this.m_trackArr.length;switch(this.m_step){case 1:(t=this.m_buffer[1-this.m_playSide])[0].fill(0),t[1].fill(0),h>0&&this.m_trackArr[r.MTrack.TEMPO_TRACK].onSampleData(null,0,e*this.bufferMultiple,!0),this.m_processTrack=r.MTrack.FIRST_TRACK,this.m_processOffset=0,this.m_step++,this.startProcTimer();break;case 2:var _=this.m_status,o=this.m_lastTime?this.m_maxProcTime+this.m_lastTime:0,m=this.worker.infoInterval,n=this.worker.lastInfoTime+m;do{if(this.m_processTrack>=h){this.m_step++;break}this.m_trackArr[this.m_processTrack].onSampleData(t,this.m_processOffset,this.m_processOffset+i),this.m_processOffset+=i,this.m_processOffset>=s&&(this.m_processTrack++,this.m_processOffset=0),2===_&&this.worker.buffering((this.m_processTrack*s+this.m_processOffset)/(h*s)*100|0),m>0&&a.getTimer()>n&&(this.worker.syncInfo(),n=this.worker.lastInfoTime+m)}while(_<3||a.getTimer()<o);m>0&&(this.worker.syncInfo(),this.worker.restartInfoTimer()),this.startProcTimer();break;case 3:this.m_step=4,2===this.m_status&&(this.m_status=3,this.m_playSide=1-this.m_playSide,this.m_playSize=0,this.m_waitPause?(this.pause(),this.m_step=1):(this.isExportingAudio||this.worker.playSound(),this.processStart()))}}onSampleData(t){if(t.bufferId===this.bufferId&&(this.m_lastTime=a.getTimer(),!(this.m_status<3))){if(this.m_globalSample/s.SAMPLE_RATE*1e3>=this.m_totalMSec)return this.stop(),void this.worker.complete();if(this.m_playSize>=this.bufferMultiple){if(4!==this.m_step)return 3===this.m_step?void 0:void this.reqBuffering();if(this.m_playSide=1-this.m_playSide,this.m_playSize=0,this.processStart(),4===this.m_status)return;3===this.m_status&&this.m_trackArr[r.MTrack.TEMPO_TRACK].isEnd()&&(this.m_status=4)}var e=this.bufferSize,i=t.retBuf||Array(2).fill(0).map((()=>new Float32Array(e))),h=e*this.m_playSize;[0,1].forEach((t=>{var s=this.m_buffer[this.m_playSide][t].subarray(h,h+e);i[t].set(s)})),this.worker.sendBuffer(i),this.bufferId++,this.m_playSize++,this.m_globalSample+=e}}createPipes(t){h.MChannel.createPipes(t)}createSyncSources(t){h.MChannel.createSyncSources(t)}isPlaying(){return this.m_status>1}isPaused(){return 1===this.m_status}getTotalMSec(){return this.m_trackArr[r.MTrack.TEMPO_TRACK]?this.m_trackArr[r.MTrack.TEMPO_TRACK].getTotalMSec():0}getNowMSec(){if(0===this.m_status)return 0;var t=this.m_globalSample/s.SAMPLE_RATE*1e3,e=this.m_lastTime?a.getTimer()-this.m_lastTime:0,i=this.bufferSize/s.SAMPLE_RATE*1e3;return this.m_maxNowMSec=Math.max(this.m_maxNowMSec,t+(this.isExportingAudio?0:Math.min(e,i))),this.m_maxNowMSec}getNowTimeStr(){var t=this.getNowMSec()/1e3,e="0"+(t/60|0),s="0"+(t%60|0);return e.substr(e.length-2,2)+":"+s.substr(s.length-2,2)}}e.MSequencer=a}.apply(e,i))||(t.exports=h)},150:(t,e,s)=>{var i,h;i=[s,e,s(587),s(870),s(42),s(949)],void 0===(h=function(t,e,s,i,h,_){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MTrack=void 0;class r{constructor(){this.m_isEnd=0,this.m_ch=new i.MChannel,this.m_needle=0,this.m_polyFound=!1,this.playTempo(r.DEFAULT_BPM),this.m_volume=100,this.recGate(15/16),this.recGate2(0),this.m_events=new Array,this.m_pointer=0,this.m_delta=0,this.m_globalTick=0,this.m_lfoWidth=0,this.m_totalMSec=0,this.m_chordBegin=0,this.m_chordEnd=0,this.m_chordMode=!1}getNumEvents(){return this.m_events.length}onSampleData(t,e,i,h=!1){if(!this.isEnd())for(var _=e;_<i;){var r,a,o,m=0,n=this.m_events.length;do{if(m=0,this.m_pointer<n&&(a=(r=this.m_events[this.m_pointer]).getDelta()*this.m_spt,this.m_needle>=a)){switch(m=1,r.getStatus()){case 2:this.m_ch.noteOn(r.getNoteNo(),r.getVelocity());break;case 3:this.m_ch.noteOff(r.getNoteNo());break;case 6:this.m_ch.setNoteNo(r.getNoteNo());break;case 5:break;case 4:this.playTempo(r.getTempo());break;case 7:this.m_ch.setForm(r.getForm(),r.getSubForm());break;case 8:this.m_ch.setEnvelope1Atk(r.getEnvelopeA());break;case 9:this.m_ch.setEnvelope1Point(r.getEnvelopeT(),r.getEnvelopeL());break;case 10:this.m_ch.setEnvelope1Rel(r.getEnvelopeR());break;case 24:this.m_ch.setEnvelope2Atk(r.getEnvelopeA());break;case 25:this.m_ch.setEnvelope2Point(r.getEnvelopeT(),r.getEnvelopeL());break;case 26:this.m_ch.setEnvelope2Rel(r.getEnvelopeR());break;case 11:this.m_ch.setNoiseFreq(r.getNoiseFreq());break;case 12:this.m_ch.setPWM(r.getPWM());break;case 13:this.m_ch.setPan(r.getPan());break;case 14:this.m_ch.setFormant(r.getVowel());break;case 15:this.m_ch.setDetune(r.getDetune());break;case 16:this.m_ch.setLFOFMSF(r.getLFOForm(),r.getLFOSubForm());break;case 17:this.m_lfoWidth=r.getLFOWidth()*this.m_spt,this.m_ch.setLFODPWD(r.getLFODepth(),s.SAMPLE_RATE/this.m_lfoWidth);break;case 18:this.m_ch.setLFODLTM(r.getLFODelay()*this.m_spt,r.getLFOTime()*this.m_lfoWidth);break;case 19:this.m_ch.setLFOTarget(r.getLFOTarget());break;case 20:this.m_ch.setLpfSwtAmt(r.getLPFSwt(),r.getLPFAmt());break;case 21:this.m_ch.setLpfFrqRes(r.getLPFFrq(),r.getLPFRes());break;case 23:this.m_ch.setVolMode(r.getVolMode());break;case 27:this.m_ch.setInput(r.getInputSens(),r.getInputPipe());break;case 28:this.m_ch.setOutput(r.getOutputMode(),r.getOutputPipe());break;case 29:this.m_ch.setExpression(r.getExpression());break;case 30:this.m_ch.setRing(r.getRingSens(),r.getRingInput());break;case 31:this.m_ch.setSync(r.getSyncMode(),r.getSyncPipe());break;case 32:this.m_ch.setPortamento(100*r.getPorDepth(),r.getPorLen()*this.m_spt);break;case 33:this.m_ch.setMidiPort(r.getMidiPort());break;case 34:var c=r.getMidiPortRate();this.m_ch.setMidiPortRate((8-7.99*c/128)/c);break;case 35:this.m_ch.setPortBase(100*r.getPortBase());break;case 36:this.m_ch.setVoiceLimit(r.getVoiceCount());break;case 39:this.m_ch.setHwLfo(r.getHwLfoData());break;case 37:this.m_ch.setSoundOff();break;case 38:this.m_ch.reset();break;case 22:this.m_ch.close();break;case 0:this.m_isEnd=1}this.m_needle-=a,this.m_pointer++}}while(m);if(!(this.m_pointer<n))break;a=(r=this.m_events[this.m_pointer]).getDelta()*this.m_spt,_+(o=Math.ceil(a-this.m_needle))>=i&&(o=i-_),this.m_needle+=o,h||this.m_ch.getSamples(t,i,_,o),_+=o}}seek(t){this.m_delta+=t,this.m_globalTick+=t,this.m_chordEnd=Math.max(this.m_chordEnd,this.m_globalTick)}seekChordStart(){this.m_globalTick=this.m_chordBegin}recDelta(t){t.setDelta(this.m_delta),this.m_delta=0}recNote(t,e,s,i=1,h=1){var _,r=this.makeEvent();i?r.setNoteOn(t,s):r.setNote(t),this.pushEvent(r),h?((_=(e*this.m_gate|0)-this.m_gate2)<=0&&(_=0),this.seek(_),this.recNoteOff(t,s),this.seek(e-_),this.m_chordMode&&this.seekChordStart()):this.seek(e)}recNoteOff(t,e){var s=this.makeEvent();s.setNoteOff(t,e),this.pushEvent(s)}recRest(t){this.seek(t),this.m_chordMode&&(this.m_chordBegin+=t)}recChordStart(){!1===this.m_chordMode&&(this.m_chordMode=!0,this.m_chordBegin=this.m_globalTick)}recChordEnd(){this.m_chordMode&&(this.m_events.length>0?this.m_delta=this.m_chordEnd-this.m_events[this.m_events.length-1].getTick():this.m_delta=0,this.m_globalTick=this.m_chordEnd,this.m_chordMode=!1)}recRestMSec(t){var e=t*s.SAMPLE_RATE/(1e3*this.m_spt)|0;this.seek(e)}recVolume(t){var e=this.makeEvent();e.setVolume(t),this.pushEvent(e)}recGlobal(t,e){for(var s=this.m_events.length,i=0,h=0;h<s;h++){var _=this.m_events[h],r=i+_.getDelta();if(r>t||r===t&&4!==_.getStatus())return _.setDelta(r-t),e.setDelta(t-i),void this.m_events.splice(h,0,e);i=r}e.setDelta(t-i),this.m_events.push(e)}insertEvent(t){for(var e=this.m_events.length,s=0,i=t.getTick(),h=0;h<e;h++){var _=this.m_events[h],r=s+_.getDelta();if(r>i)return _.setDelta(r-i),t.setDelta(i-s),void this.m_events.splice(h,0,t);s=r}t.setDelta(i-s),this.m_events.push(t)}makeEvent(){var t=new h.MEvent(this.m_globalTick);return t.setDelta(this.m_delta),this.m_delta=0,t}pushEvent(t){!1===this.m_chordMode?this.m_events.push(t):this.insertEvent(t)}recTempo(t,e){var s=new h.MEvent(t);s.setTempo(e),this.recGlobal(t,s)}recEOT(){var t=this.makeEvent();t.setEOT(),this.pushEvent(t)}recGate(t){this.m_gate=t}recGate2(t){t<0&&(t=0),this.m_gate2=t}recForm(t,e){var s=this.makeEvent();s.setForm(t,e),this.pushEvent(s)}recEnvelope(t,e,s,i,h){var _=this.makeEvent();1===t?_.setEnvelope1Atk(e):_.setEnvelope2Atk(e),this.pushEvent(_);for(var r=0,a=s.length;r<a;r++)_=this.makeEvent(),1===t?_.setEnvelope1Point(s[r],i[r]):_.setEnvelope2Point(s[r],i[r]),this.pushEvent(_);_=this.makeEvent(),1===t?_.setEnvelope1Rel(h):_.setEnvelope2Rel(h),this.pushEvent(_)}recNoiseFreq(t){var e=this.makeEvent();e.setNoiseFreq(t),this.pushEvent(e)}recPWM(t){var e=this.makeEvent();e.setPWM(t),this.pushEvent(e)}recPan(t){var e=this.makeEvent();e.setPan(t),this.pushEvent(e)}recFormant(t){var e=this.makeEvent();e.setFormant(t),this.pushEvent(e)}recDetune(t){var e=this.makeEvent();e.setDetune(t),this.pushEvent(e)}recLFO(t,e,s,i,h,_,r){var a=this.makeEvent();a.setLFOFMSF(s,i),this.pushEvent(a),(a=this.makeEvent()).setLFODPWD(t,e),this.pushEvent(a),(a=this.makeEvent()).setLFODLTM(h,_),this.pushEvent(a),(a=this.makeEvent()).setLFOTarget(r),this.pushEvent(a)}recLPF(t,e,s,i){var h=this.makeEvent();h.setLPFSWTAMT(t,e),this.pushEvent(h),(h=this.makeEvent()).setLPFFRQRES(s,i),this.pushEvent(h)}recVolMode(t){var e=this.makeEvent();e.setVolMode(t),this.pushEvent(e)}recInput(t,e){var s=this.makeEvent();s.setInput(t,e),this.pushEvent(s)}recOutput(t,e){var s=this.makeEvent();s.setOutput(t,e),this.pushEvent(s)}recExpression(t){var e=this.makeEvent();e.setExpression(t),this.pushEvent(e)}recRing(t,e){var s=this.makeEvent();s.setRing(t,e),this.pushEvent(s)}recSync(t,e){var s=this.makeEvent();s.setSync(t,e),this.pushEvent(s)}recClose(){var t=this.makeEvent();t.setClose(),this.pushEvent(t)}recPortamento(t,e){var s=this.makeEvent();s.setPortamento(t,e),this.pushEvent(s)}recMidiPort(t){var e=this.makeEvent();e.setMidiPort(t),this.pushEvent(e)}recMidiPortRate(t){var e=this.makeEvent();e.setMidiPortRate(t),this.pushEvent(e)}recPortBase(t){var e=this.makeEvent();e.setPortBase(t),this.pushEvent(e)}recPoly(t){var e=this.makeEvent();e.setPoly(t),this.pushEvent(e),this.m_polyFound=!0}recHwLfo(t,e,s,i,h,_,r){var a=this.makeEvent();a.setHwLfo(t,e,s,i,h,_,r),this.pushEvent(a)}isEnd(){return this.m_isEnd}getRecGlobalTick(){return this.m_globalTick}seekTop(){this.m_globalTick=0}conduct(t){var e,i,h,_=this.m_events.length,a=t.length,o=0,m=0,n=this.calcSpt(r.DEFAULT_BPM);for(e=0;e<_;e++)switch(o+=(h=this.m_events[e]).getDelta(),m+=h.getDelta()*n,h.getStatus()){case 4:for(n=this.calcSpt(h.getTempo()),i=r.FIRST_TRACK;i<a;i++)t[i].recTempo(o,h.getTempo())}var c=0;for(i=r.FIRST_TRACK;i<a;i++)c<t[i].getRecGlobalTick()&&(c=t[i].getRecGlobalTick());(h=this.makeEvent()).setClose(),this.recGlobal(c,h),m+=(c-o)*n,this.recRestMSec(3e3),this.recEOT(),m+=3*s.SAMPLE_RATE,this.m_totalMSec=1e3*m/s.SAMPLE_RATE}calcSpt(t){var e=96*t/60;return s.SAMPLE_RATE/e}playTempo(t){this.m_bpm=t,this.m_spt=this.calcSpt(t)}getTotalMSec(){return this.m_totalMSec}getTotalTimeStr(){var t=Math.ceil(this.m_totalMSec/1e3),e="0"+Math.floor(t/60),s="0"+t%60;return e.substr(e.length-2,2)+":"+s.substr(s.length-2,2)}getVoiceCount(){return this.m_ch.getVoiceCount()}usingMono(){this.m_ch=new i.MChannel}usingPoly(t){this.m_ch=new _.MPolyChannel(t)}findPoly(){return this.m_polyFound}}e.MTrack=r,r.TEMPO_TRACK=0,r.FIRST_TRACK=1,r.DEFAULT_BPM=120}.apply(e,i))||(t.exports=h)},433:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.MWarning=void 0;class s{static getString(t,e){return this.s_string[t].replace("%s",e)}}e.MWarning=s,s.UNKNOWN_COMMAND=0,s.UNCLOSED_REPEAT=1,s.UNOPENED_COMMENT=2,s.UNCLOSED_COMMENT=3,s.RECURSIVE_MACRO=4,s.UNCLOSED_ARGQUOTE=5,s.UNCLOSED_GROUPNOTES=6,s.UNOPENED_GROUPNOTES=7,s.INVALID_MACRO_NAME=8,s.s_string=["対応していないコマンド '%s' があります。","終わりが見つからない繰り返しがあります。","始まりが見つからないコメントがあります。","終わりが見つからないコメントがあります。","マクロが再帰的に呼び出されています。",'マクロ引数指定の "" が閉じられていません',"終りが見つからない連符があります","始まりが見つからない連符があります","マクロ名に使用できない文字が含まれています。'%s'"]}.apply(e,[s,e]))||(t.exports=i)},355:(t,e,s)=>{var i,h;i=[s,e,s(613),s(781)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Channel4=void 0;class h{constructor(){this.buf=new Array(4),this.ix=new Array(3),this.ox=new Array(3),this.op=[new i.Operator,new i.Operator,new i.Operator,new i.Operator],this.SetAlgorithm(0),this.pms=h.pmtable[0][0]}SetType(t){for(var e=0;e<4;e++)this.op[e].type_=t}SetFB(t){this.fb=h.fbtable[t]}SetMS(t){this.op[0].SetMS(t),this.op[1].SetMS(t),this.op[2].SetMS(t),this.op[3].SetMS(t)}Mute(t){for(var e=0;e<4;e++)this.op[e].Mute(t)}Refresh(){for(var t=0;t<4;t++)this.op[t].Refresh()}SetChip(t){this.chip_=t;for(var e=0;e<4;e++)this.op[e].SetChip(t)}Reset(){this.op[0].Reset(),this.op[1].Reset(),this.op[2].Reset(),this.op[3].Reset()}Prepare(){var t=this.op;return t[0].Prepare(),t[1].Prepare(),t[2].Prepare(),t[3].Prepare(),this.pms=h.pmtable[t[0].type_][7&t[0].ms_],(t[0].IsOn()||t[1].IsOn()||t[2].IsOn()||t[3].IsOn()?1:0)|(t[0].ms_&(t[0].amon_||t[1].amon_||t[2].amon_||t[3].amon_?55:7)?2:0)}SetFNum(t){for(var e=0;e<4;e++)this.op[e].SetFNum(t)}SetKCKF(t,e){var s=19-(t>>4&7),i=h.kctable[15&t],_=(i=4*((i+2)/4|0))*h.kftable[63&e];_>>=19,_<<=19,_>>=s;var r=t>>2&31;this.op[0].SetDPBN(_,r),this.op[1].SetDPBN(_,r),this.op[2].SetDPBN(_,r),this.op[3].SetDPBN(_,r)}KeyControl(t){var e=this.op;1&t?e[0].KeyOn():e[0].KeyOff(),2&t?e[1].KeyOn():e[1].KeyOff(),4&t?e[2].KeyOn():e[2].KeyOff(),8&t?e[3].KeyOn():e[3].KeyOff()}SetAlgorithm(t){var e=h.iotable;this.ix[0]=e[t][0],this.ox[0]=e[t][1],this.ix[1]=e[t][2],this.ox[1]=e[t][3],this.ix[2]=e[t][4],this.ox[2]=e[t][5],this.op[0].ResetFB(),this.algo_=t}GetAlgorithm(){return this.algo_}Calc(){var t=0;switch(this.algo_){case 0:this.op[2].Calc(this.op[1].Out()),this.op[1].Calc(this.op[0].Out()),t=this.op[3].Calc(this.op[2].Out()),this.op[0].CalcFB(this.fb);break;case 1:this.op[2].Calc(this.op[0].Out()+this.op[1].Out()),this.op[1].Calc(0),t=this.op[3].Calc(this.op[2].Out()),this.op[0].CalcFB(this.fb);break;case 2:this.op[2].Calc(this.op[1].Out()),this.op[1].Calc(0),t=this.op[3].Calc(this.op[0].Out()+this.op[2].Out()),this.op[0].CalcFB(this.fb);break;case 3:this.op[2].Calc(0),this.op[1].Calc(this.op[0].Out()),t=this.op[3].Calc(this.op[1].Out()+this.op[2].Out()),this.op[0].CalcFB(this.fb);break;case 4:this.op[2].Calc(0),t=this.op[1].Calc(this.op[0].Out()),t+=this.op[3].Calc(this.op[2].Out()),this.op[0].CalcFB(this.fb);break;case 5:t=this.op[2].Calc(this.op[0].Out()),t+=this.op[1].Calc(this.op[0].Out()),t+=this.op[3].Calc(this.op[0].Out()),this.op[0].CalcFB(this.fb);break;case 6:t=this.op[2].Calc(0),t+=this.op[1].Calc(this.op[0].Out()),t+=this.op[3].Calc(0),this.op[0].CalcFB(this.fb);break;case 7:t=this.op[2].Calc(0),t+=this.op[1].Calc(0),t+=this.op[3].Calc(0),t+=this.op[0].CalcFB(this.fb)}return t}CalcL(){this.chip_.SetPMV(this.pms[this.chip_.GetPML()]);var t=0;switch(this.algo_){case 0:this.op[2].CalcL(this.op[1].Out()),this.op[1].CalcL(this.op[0].Out()),t=this.op[3].CalcL(this.op[2].Out()),this.op[0].CalcFBL(this.fb);break;case 1:this.op[2].CalcL(this.op[0].Out()+this.op[1].Out()),this.op[1].CalcL(0),t=this.op[3].CalcL(this.op[2].Out()),this.op[0].CalcFBL(this.fb);break;case 2:this.op[2].CalcL(this.op[1].Out()),this.op[1].CalcL(0),t=this.op[3].CalcL(this.op[0].Out()+this.op[2].Out()),this.op[0].CalcFBL(this.fb);break;case 3:this.op[2].CalcL(0),this.op[1].CalcL(this.op[0].Out()),t=this.op[3].CalcL(this.op[1].Out()+this.op[2].Out()),this.op[0].CalcFBL(this.fb);break;case 4:this.op[2].CalcL(0),t=this.op[1].CalcL(this.op[0].Out()),t+=this.op[3].CalcL(this.op[2].Out()),this.op[0].CalcFBL(this.fb);break;case 5:t=this.op[2].CalcL(this.op[0].Out()),t+=this.op[1].CalcL(this.op[0].Out()),t+=this.op[3].CalcL(this.op[0].Out()),this.op[0].CalcFBL(this.fb);break;case 6:t=this.op[2].CalcL(0),t+=this.op[1].CalcL(this.op[0].Out()),t+=this.op[3].CalcL(0),this.op[0].CalcFBL(this.fb);break;case 7:t=this.op[2].CalcL(0),t+=this.op[1].CalcL(0),t+=this.op[3].CalcL(0),t+=this.op[0].CalcFBL(this.fb)}return t}CalcN(t){this.buf[1]=this.buf[2]=this.buf[3]=0,this.buf[0]=this.op[0].Out(),this.op[0].CalcFB(this.fb),this.buf[this.ox[0]]+=this.op[1].Calc(this.buf[this.ix[0]]),this.buf[this.ox[1]]+=this.op[2].Calc(this.buf[this.ix[1]]);var e=this.op[3].Out();return this.op[3].CalcN(t),this.buf[this.ox[2]]+e}CalcLN(t){this.chip_.SetPMV(this.pms[this.chip_.GetPML()]),this.buf[1]=this.buf[2]=this.buf[3]=0,this.buf[0]=this.op[0].Out(),this.op[0].CalcFBL(this.fb),this.buf[this.ox[0]]+=this.op[1].CalcL(this.buf[this.ix[0]]),this.buf[this.ox[1]]+=this.op[2].CalcL(this.buf[this.ix[1]]);var e=this.op[3].Out();return this.op[3].CalcN(t),this.buf[this.ox[2]]+e}}e.Channel4=h,h.fbtable=[31,7,6,5,4,3,2,1],h.kftable=[65536,65595,65654,65713,65773,65832,65891,65951,66010,66070,66130,66189,66249,66309,66369,66429,66489,66549,66609,66669,66729,66789,66850,66910,66971,67031,67092,67152,67213,67273,67334,67395,67456,67517,67578,67639,67700,67761,67822,67883,67945,68006,68067,68129,68190,68252,68314,68375,68437,68499,68561,68623,68685,68747,68809,68871,68933,68995,69057,69120,69182,69245,69307,69370],h.kctable=[5197,5506,5833,6180,6180,6547,6937,7349,7349,7786,8249,8740,8740,9259,9810,10394],h.iotable=[[0,1,1,2,2,3],[1,0,0,1,1,2],[1,1,1,0,0,2],[0,1,2,1,1,2],[0,1,2,2,2,1],[0,1,0,1,0,1],[0,1,2,1,2,1],[1,0,1,0,1,0]],h.pmtable=(()=>{for(var t,e,i=s.JaggArray.I3(2,8,256),h=[[0,1/360,2/360,3/360,4/360,6/360,12/360,24/360],[0,1/480,2/480,4/480,10/480,20/480,80/480,140/480]],_=0;_<2;_++)for(t=0;t<8;t++){var r=h[_][t];for(e=0;e<256;e++){Math.pow(2,r*(2*e-256+1)/255);var a=.6*r*Math.sin(2*e*Math.PI/256)+1;i[_][t][e]=65536*(a-1)|0}}return i})()}.apply(e,i))||(t.exports=h)},226:(t,e,s)=>{var i,h;i=[s,e,s(613)],void 0===(h=function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Chip=void 0;var i=[1,1.414,1.581,1.732];e.Chip=class{constructor(){this.ratio_=0,this.aml_=0,this.pml_=0,this.pmv_=0,this.multable_=s.JaggArray.I2(4,16)}Chip(){this.MakeTable()}SetRatio(t){this.ratio_!==t&&(this.ratio_=t,this.MakeTable())}SetAML(t){this.aml_=255&t}SetPML(t){this.pml_=255&t}SetPMV(t){this.pmv_=t}GetMulValue(t,e){return this.multable_[t][e]}GetAML(){return this.aml_}GetPML(){return this.pml_}GetPMV(){return this.pmv_}GetRatio(){return this.ratio_}MakeTable(){var t,e;for(t=0;t<4;t++){var s=i[t]*this.ratio_/1;for(e=0;e<16;e++){var h=0!==e?2*e:1;this.multable_[t][e]=h*s|0}}}}}.apply(e,i))||(t.exports=h)},655:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.EGPhase=void 0;class s{}e.EGPhase=s,s.next=0,s.attack=1,s.decay=2,s.sustain=3,s.release=4,s.off=5}.apply(e,[s,e]))||(t.exports=i)},613:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.JaggArray=void 0,e.JaggArray=class{static I2(t,e){for(var s=new Array(t),i=0;i<t;i++)s[i]=new Array(e);return s}static I3(t,e,s){for(var i=new Array(t),h=0;h<t;h++){i[h]=new Array(e);for(var _=0;_<e;_++)i[h][_]=new Array(s)}return i}}}.apply(e,[s,e]))||(t.exports=i)},750:(t,e,s)=>{var i,h;i=[s,e,s(355),s(226),s(655),s(613),s(781),s(805),s(430)],void 0===(h=function(t,e,s,i,h,_,r,a,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OPM=void 0;class m extends o.Timer{constructor(){super(),this.amplevel=16384,this.lfo_step_=0,this.kc=new Array(8),this.kf=new Array(8),this.pan=new Array(8),this.chip=new i.Chip,this.buf=new Array(4),this.ch=[new s.Channel4,new s.Channel4,new s.Channel4,new s.Channel4,new s.Channel4,new s.Channel4,new s.Channel4,new s.Channel4],this.lfo_count_=0,this.lfo_count_prev_=-1,m.BuildLFOTable();for(var t=0;t<8;t++)this.ch[t].SetChip(this.chip),this.ch[t].SetType(a.OpType.typeM);this.ix=this.ch[0].ix,this.ox=this.ch[0].ox}static BuildLFOTable(){if(!this.s_init){for(var t=0;t<4;t++)for(var e=0,s=0;s<512;s++){var i=0,h=0;switch(t){case 0:h=(s+256&511)/2-128,i=255-s/2;break;case 1:i=s<256?255:0,h=s<256?127:-128;break;case 2:h=(h=s+128&511)<256?h-128:383-h,i=s<256?255-s:s-256;break;case 3:0==(3&s)&&(e=(32768*Math.random()|0)/17&255),i=e,h=e-128}this.amtable[t][s]=i,this.pmtable[t][s]=-h-1}this.s_init=!0}}Init(t,e){return!!this.SetRate(t,e)&&(this.Reset(),this.SetVolume(0),this.SetChannelMask(0),!0)}SetRate(t,e){return this.clock=t,this.pcmrate=e,this.rate=e,this.RebuildTimeTable(),!0}SetChannelMask(t){for(var e=0;e<8;e++)this.ch[e].Mute(0!=(t&1<<e))}Reset(){var t;for(t=0;t<256;t++)this.SetReg(t,0);for(this.SetReg(25,128),super.Reset(),this.status=0,this.noise=12345,this.noisecount=0,t=0;t<8;t++)this.ch[t].Reset()}RebuildTimeTable(){var t=this.clock/64|0;this.rateratio=((t<<7)+this.rate/2)/this.rate|0,this.SetTimerBase(t),this.chip.SetRatio(this.rateratio)}TimerA(){if(128&this.regtc)for(var t=0;t<8;t++)this.ch[t].KeyControl(0),this.ch[t].KeyControl(15)}SetVolume(t){t=Math.min(t,20),this.fmvolume=t>-192?16384*Math.pow(10,t/40)|0:0}SetExpression(t){this.amplevel=16384*t|0}ReadStatus(){return 3&this.status}SetStatus(t){0==(this.status&t)&&(this.status|=t,this.Intr(!0))}ResetStatus(t){this.status&t&&(this.status&=~t,0===this.status&&this.Intr(!1))}SetReg(t,e){if(!(t>=256)){var s=7&t;switch(255&t){case 1:2&e&&(this.lfo_count_=0,this.lfo_count_prev_=-1),this.reg01=e;break;case 8:0==(128&this.regtc)?this.ch[7&e].KeyControl(e>>3):(s=7&e,0==(8&e)&&this.ch[s].op[0].KeyOff(),0==(16&e)&&this.ch[s].op[1].KeyOff(),0==(32&e)&&this.ch[s].op[2].KeyOff(),0==(64&e)&&this.ch[s].op[3].KeyOff());break;case 16:case 17:this.SetTimerA(t,e);break;case 18:this.SetTimerB(e);break;case 20:this.SetTimerControl(e);break;case 24:this.lfofreq=e,this.lfo_count_diff_=this.rateratio*(16+(15&this.lfofreq)<<5)/(1<<15-(this.lfofreq>>4));break;case 25:128&e?this.pmd=127&e:this.amd=127&e;break;case 27:this.lfowaveform=3&e;break;case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:this.ch[s].SetFB(e>>3&7),this.ch[s].SetAlgorithm(7&e),this.pan[s]=e>>6&3;break;case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:this.kc[s]=e,this.ch[s].SetKCKF(this.kc[s],this.kf[s]);break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:this.kf[s]=e>>2,this.ch[s].SetKCKF(this.kc[s],this.kf[s]);break;case 56:case 57:case 58:case 59:case 60:case 61:case 62:case 63:this.ch[s].SetMS(e<<4|e>>4);break;case 15:this.noisedelta=e,this.noisecount=0;break;default:t>=64&&this.SetParameter(t,e)}}}SetParameter(t,e){var s=m.slottable[t>>3&3],i=this.ch[7&t].op[s];switch(t>>5&7){case 2:i.SetDT(e>>4&7),i.SetMULTI(15&e);break;case 3:i.SetTL(127&e,0!=(128&this.regtc));break;case 4:i.SetKS(e>>6&3),i.SetAR(2*(31&e));break;case 5:i.SetDR(2*(31&e)),i.SetAMON(0!=(128&e));break;case 6:i.SetSR(2*(31&e)),i.SetDT2(e>>6&3);break;case 7:i.SetSL(m.sltable[e>>4&15]),i.SetRR(4*(15&e)+2)}}Mix(t,e,s){var i,_=0;for(i=0;i<8;i++)_=_<<2|this.ch[i].Prepare();if(21845&_){var a,o,n,c,l,p,u;2&this.reg01&&(_&=21845),this.ch[0].algo_;var g=this.ch[0].fb,f=this.ch[0].op[0],S=this.ch[0].op[1],v=this.ch[0].op[2],d=this.ch[0].op[3],M=this.buf,E=this.ix,P=this.ox,b=m.cltable,A=m.sinetable,O=m.attacktable,N=m.decaytable1;if(3!==this.lfowaveform)var y=m.pmtable,T=m.amtable;for(i=e;i<e+s;i++)3!==this.lfowaveform?(o=this.lfo_count_>>15&510,this.chip.pml_=y[this.lfowaveform][o]*this.pmd/128+128&255,this.chip.aml_=T[this.lfowaveform][o]*this.amd/128&255):-131072&(this.lfo_count_^this.lfo_count_prev_)&&(o=(32768*Math.random()|0)/17&255,this.chip.pml_=(o-128)*this.pmd/128+128&255,this.chip.aml_=o*this.amd/128&255),this.lfo_count_prev_=this.lfo_count_,this.lfo_step_++,0==(7&this.lfo_step_)&&(this.lfo_count_+=this.lfo_count_diff_),n=0,16384&_&&(43690&_?(this.ch[0].chip_.pmv_=this.ch[0].pms[this.ch[0].chip_.pml_],M[1]=M[2]=M[3]=0,M[0]=f.out_,f.eg_count_-=f.eg_count_diff_,f.eg_count_<=0&&(f.eg_count_=786048,f.eg_phase_===h.EGPhase.attack?(o=O[f.eg_rate_][7&f.eg_curve_count_])>=0&&(f.eg_level_-=1+(f.eg_level_>>o),f.eg_level_<=0&&f.ShiftPhase(h.EGPhase.decay)):(f.eg_level_+=N[f.eg_rate_][7&f.eg_curve_count_],f.eg_level_>=f.eg_level_on_next_phase_&&f.ShiftPhase(f.eg_phase_+1)),a=f.tl_out_+f.eg_level_,f.eg_out_=a<1023?a<<3:8184,f.eg_curve_count_++),c=f.out_+f.out2_,f.out2_=f.out_,l=f.pg_count_,f.pg_count_+=f.pg_diff_+(f.pg_diff_lfo_*f.chip_.pmv_>>5),p=l>>19,g<31&&(p+=c<<1+r.Operator.IS2EC_SHIFT>>g>>19),u=f.eg_out_+A[1023&p]+f.ams_[f.chip_.aml_],f.out_=u<8192?b[u]:0,S.eg_count_-=S.eg_count_diff_,S.eg_count_<=0&&(S.eg_count_=786048,S.eg_phase_===h.EGPhase.attack?(o=O[S.eg_rate_][7&S.eg_curve_count_])>=0&&(S.eg_level_-=1+(S.eg_level_>>o),S.eg_level_<=0&&S.ShiftPhase(h.EGPhase.decay)):(S.eg_level_+=N[S.eg_rate_][7&S.eg_curve_count_],S.eg_level_>=S.eg_level_on_next_phase_&&S.ShiftPhase(S.eg_phase_+1)),a=S.tl_out_+S.eg_level_,S.eg_out_=a<1023?a<<3:8184,S.eg_curve_count_++),c=M[E[0]],S.out2_=S.out_,l=S.pg_count_,S.pg_count_+=S.pg_diff_+(S.pg_diff_lfo_*S.chip_.pmv_>>5),p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=S.eg_out_+A[1023&p]+S.ams_[S.chip_.aml_],S.out_=u<8192?b[u]:0,M[P[0]]+=S.out_,v.eg_count_-=v.eg_count_diff_,v.eg_count_<=0&&(v.eg_count_=786048,v.eg_phase_===h.EGPhase.attack?(o=O[v.eg_rate_][7&v.eg_curve_count_])>=0&&(v.eg_level_-=1+(v.eg_level_>>o),v.eg_level_<=0&&v.ShiftPhase(h.EGPhase.decay)):(v.eg_level_+=N[v.eg_rate_][7&v.eg_curve_count_],v.eg_level_>=v.eg_level_on_next_phase_&&v.ShiftPhase(v.eg_phase_+1)),a=v.tl_out_+v.eg_level_,v.eg_out_=a<1023?a<<3:8184,v.eg_curve_count_++),c=M[E[1]],v.out2_=v.out_,l=v.pg_count_,v.pg_count_+=v.pg_diff_+(v.pg_diff_lfo_*v.chip_.pmv_>>5),p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=v.eg_out_+A[1023&p]+v.ams_[v.chip_.aml_],v.out_=u<8192?b[u]:0,M[P[1]]+=v.out_,d.eg_count_-=d.eg_count_diff_,d.eg_count_<=0&&(d.eg_count_=786048,d.eg_phase_===h.EGPhase.attack?(o=O[d.eg_rate_][7&d.eg_curve_count_])>=0&&(d.eg_level_-=1+(d.eg_level_>>o),d.eg_level_<=0&&d.ShiftPhase(h.EGPhase.decay)):(d.eg_level_+=N[d.eg_rate_][7&d.eg_curve_count_],d.eg_level_>=d.eg_level_on_next_phase_&&d.ShiftPhase(d.eg_phase_+1)),a=d.tl_out_+d.eg_level_,d.eg_out_=a<1023?a<<3:8184,d.eg_curve_count_++),c=M[E[2]],d.out2_=d.out_,l=d.pg_count_,d.pg_count_+=d.pg_diff_+(d.pg_diff_lfo_*d.chip_.pmv_>>5),p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=d.eg_out_+A[1023&p]+d.ams_[d.chip_.aml_],d.out_=u<8192?b[u]:0,n=M[P[2]]+d.out_):(M[1]=M[2]=M[3]=0,M[0]=f.out_,f.eg_count_-=f.eg_count_diff_,f.eg_count_<=0&&(f.eg_count_=786048,f.eg_phase_===h.EGPhase.attack?(o=O[f.eg_rate_][7&f.eg_curve_count_])>=0&&(f.eg_level_-=1+(f.eg_level_>>o),f.eg_level_<=0&&f.ShiftPhase(h.EGPhase.decay)):(f.eg_level_+=N[f.eg_rate_][7&f.eg_curve_count_],f.eg_level_>=f.eg_level_on_next_phase_&&f.ShiftPhase(f.eg_phase_+1)),a=f.tl_out_+f.eg_level_,f.eg_out_=a<1023?a<<3:8184,f.eg_curve_count_++),c=f.out_+f.out2_,f.out2_=f.out_,l=f.pg_count_,f.pg_count_+=f.pg_diff_,p=l>>19,g<31&&(p+=c<<1+r.Operator.IS2EC_SHIFT>>g>>19),u=f.eg_out_+A[1023&p],f.out_=u<8192?b[u]:0,S.eg_count_-=S.eg_count_diff_,S.eg_count_<=0&&(S.eg_count_=786048,S.eg_phase_===h.EGPhase.attack?(o=O[S.eg_rate_][7&S.eg_curve_count_])>=0&&(S.eg_level_-=1+(S.eg_level_>>o),S.eg_level_<=0&&S.ShiftPhase(h.EGPhase.decay)):(S.eg_level_+=N[S.eg_rate_][7&S.eg_curve_count_],S.eg_level_>=S.eg_level_on_next_phase_&&S.ShiftPhase(S.eg_phase_+1)),a=S.tl_out_+S.eg_level_,S.eg_out_=a<1023?a<<3:8184,S.eg_curve_count_++),c=M[E[0]],S.out2_=S.out_,l=S.pg_count_,S.pg_count_+=S.pg_diff_,p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=S.eg_out_+A[1023&p],S.out_=u<8192?b[u]:0,M[P[0]]+=S.out_,v.eg_count_-=v.eg_count_diff_,v.eg_count_<=0&&(v.eg_count_=786048,v.eg_phase_===h.EGPhase.attack?(o=O[v.eg_rate_][7&v.eg_curve_count_])>=0&&(v.eg_level_-=1+(v.eg_level_>>o),v.eg_level_<=0&&v.ShiftPhase(h.EGPhase.decay)):(v.eg_level_+=N[v.eg_rate_][7&v.eg_curve_count_],v.eg_level_>=v.eg_level_on_next_phase_&&v.ShiftPhase(v.eg_phase_+1)),a=v.tl_out_+v.eg_level_,v.eg_out_=a<1023?a<<3:8184,v.eg_curve_count_++),c=M[E[1]],v.out2_=v.out_,l=v.pg_count_,v.pg_count_+=v.pg_diff_,p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=v.eg_out_+A[1023&p],v.out_=u<8192?b[u]:0,M[P[1]]+=v.out_,d.eg_count_-=d.eg_count_diff_,d.eg_count_<=0&&(d.eg_count_=786048,d.eg_phase_===h.EGPhase.attack?(o=O[d.eg_rate_][7&d.eg_curve_count_])>=0&&(d.eg_level_-=1+(d.eg_level_>>o),d.eg_level_<=0&&d.ShiftPhase(h.EGPhase.decay)):(d.eg_level_+=N[d.eg_rate_][7&d.eg_curve_count_],d.eg_level_>=d.eg_level_on_next_phase_&&d.ShiftPhase(d.eg_phase_+1)),a=d.tl_out_+d.eg_level_,d.eg_out_=a<1023?a<<3:8184,d.eg_curve_count_++),c=M[E[2]],d.out2_=d.out_,l=d.pg_count_,d.pg_count_+=d.pg_diff_,p=l>>19,p+=c>>19-(2+r.Operator.IS2EC_SHIFT),u=d.eg_out_+A[1023&p],d.out_=u<8192?b[u]:0,n=M[P[2]]+d.out_),t[i]=((n*this.fmvolume>>14)*this.amplevel>>14)/8192)}else t.fill(0,e,s)}Intr(t){}IsOn(t){var e=this.ch[7&t];switch(e.algo_){case 0:case 1:case 2:case 3:return e.op[3].eg_phase_!==h.EGPhase.off;case 4:return e.op[1].eg_phase_!==h.EGPhase.off||e.op[3].eg_phase_!==h.EGPhase.off;case 5:case 6:return e.op[1].eg_phase_!==h.EGPhase.off||e.op[2].eg_phase_!==h.EGPhase.off||e.op[3].eg_phase_!==h.EGPhase.off;case 7:return e.op[0].eg_phase_!==h.EGPhase.off||e.op[1].eg_phase_!==h.EGPhase.off||e.op[2].eg_phase_!==h.EGPhase.off||e.op[3].eg_phase_!==h.EGPhase.off}return!1}}e.OPM=m,m.s_init=!1,m.amtable=_.JaggArray.I2(4,512),m.pmtable=_.JaggArray.I2(4,512),m.sltable=[0,4,8,12,16,20,24,28,32,36,40,44,48,52,56,124],m.slottable=[0,2,1,3],m.decaytable1=r.Operator.decaytable1,m.attacktable=r.Operator.attacktable,m.sinetable=r.Operator.sinetable,m.cltable=r.Operator.cltable}.apply(e,i))||(t.exports=h)},805:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OpType=void 0;class s{}e.OpType=s,s.typeN=0,s.typeM=1}.apply(e,[s,e]))||(t.exports=i)},781:(t,e,s)=>{var i,h;i=[s,e,s(655),s(613)],void 0===(h=function(t,e,s,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Operator=void 0;class h{constructor(){this.chip_=null,this.ar_=this.dr_=this.sr_=this.rr_=this.key_scale_rate_=0,this.ams_=h.amtable[0][0],this.mute_=!1,this.keyon_=!1,this.tl_out_=0,this.ssg_type_=0,this.multiple_=0,this.detune_=0,this.detune2_=0,this.ms_=0}SetChip(t){this.chip_=t}Reset(){this.tl_=this.tl_latch_=127,this.ShiftPhase(s.EGPhase.off),this.eg_count_=0,this.eg_curve_count_=0,this.ssg_phase_=0,this.pg_count_=0,this.out_=this.out2_=0,this.param_changed_=!0}SetDPBN(t,e){this.dp_=t,this.bn_=e,this.param_changed_=!0}Prepare(){if(!1!==this.param_changed_){switch(this.param_changed_=!1,this.pg_diff_=(this.dp_+h.dttable[this.detune_+this.bn_])*this.chip_.GetMulValue(this.detune2_,this.multiple_),this.pg_diff_lfo_=this.pg_diff_>>11,this.key_scale_rate_=this.bn_>>3-this.ks_,this.tl_out_=this.mute_?1023:8*this.tl_,this.eg_phase_){case s.EGPhase.attack:this.SetEGRate(0!==this.ar_?Math.min(63,this.ar_+this.key_scale_rate_):0);break;case s.EGPhase.decay:this.SetEGRate(0!==this.dr_?Math.min(63,this.dr_+this.key_scale_rate_):0),this.eg_level_on_next_phase_=8*this.sl_;break;case s.EGPhase.sustain:this.SetEGRate(0!==this.sr_?Math.min(63,this.sr_+this.key_scale_rate_):0);break;case s.EGPhase.release:this.SetEGRate(Math.min(63,this.rr_+this.key_scale_rate_))}if(0!==this.ssg_type_&&this.eg_phase_!==s.EGPhase.release){var t=this.ar_>=(8===this.ssg_type_||12===this.ssg_type_?56:60)?1:0;this.ssg_offset_=512*h.ssgenvtable[7&this.ssg_type_][t][this.ssg_phase_][0],this.ssg_vector_=h.ssgenvtable[7&this.ssg_type_][t][this.ssg_phase_][1]}this.ams_=h.amtable[0|this.type_][this.amon_?this.ms_>>4&3:0],this.EGUpdate()}}ShiftPhase(t){switch(t){case s.EGPhase.attack:if(this.tl_=this.tl_latch_,0!==this.ssg_type_){this.ssg_phase_=this.ssg_phase_+1,this.ssg_phase_>2&&(this.ssg_phase_=1);var e=this.ar_>=(8===this.ssg_type_||12===this.ssg_type_?56:60)?1:0;this.ssg_offset_=512*h.ssgenvtable[7&this.ssg_type_][e][this.ssg_phase_][0],this.ssg_vector_=h.ssgenvtable[7&this.ssg_type_][e][this.ssg_phase_][1]}if(this.ar_+this.key_scale_rate_<62){this.SetEGRate(0!==this.ar_?Math.min(63,this.ar_+this.key_scale_rate_):0),this.eg_phase_=s.EGPhase.attack;break}case s.EGPhase.decay:if(0!==this.sl_){this.eg_level_=0,this.eg_level_on_next_phase_=0!==this.ssg_type_?Math.min(8*this.sl_,512):8*this.sl_,this.SetEGRate(0!==this.dr_?Math.min(63,this.dr_+this.key_scale_rate_):0),this.eg_phase_=s.EGPhase.decay;break}case s.EGPhase.sustain:this.eg_level_=8*this.sl_,this.eg_level_on_next_phase_=0!==this.ssg_type_?512:1024,this.SetEGRate(0!==this.sr_?Math.min(63,this.sr_+this.key_scale_rate_):0),this.eg_phase_=s.EGPhase.sustain;break;case s.EGPhase.release:if(0!==this.ssg_type_&&(this.eg_level_=this.eg_level_*this.ssg_vector_+this.ssg_offset_,this.ssg_vector_=1,this.ssg_offset_=0),this.eg_phase_===s.EGPhase.attack||this.eg_level_<955){this.eg_level_on_next_phase_=1024,this.SetEGRate(Math.min(63,this.rr_+this.key_scale_rate_)),this.eg_phase_=s.EGPhase.release;break}case s.EGPhase.off:default:this.eg_level_=955,this.eg_level_on_next_phase_=955,this.EGUpdate(),this.SetEGRate(0),this.eg_phase_=s.EGPhase.off}}SetFNum(t){this.dp_=(2047&t)<<(t>>11&7),this.bn_=h.notetable[t>>7&127],this.param_changed_=!0}SINE(t){return h.sinetable[1023&t]}LogToLin(t){return t<8192?h.cltable[t]:0}EGUpdate(){var t=0===this.ssg_type_?this.tl_out_+this.eg_level_:this.tl_out_+this.eg_level_*this.ssg_vector_+this.ssg_offset_;this.eg_out_=t<1023?t<<3:8184}SetEGRate(t){this.eg_rate_=t,this.eg_count_diff_=h.decaytable2[t/4|0]*this.chip_.GetRatio()}EGCalc(){if(this.eg_count_=786048,this.eg_phase_===s.EGPhase.attack){var t=h.attacktable[this.eg_rate_][7&this.eg_curve_count_];t>=0&&(this.eg_level_-=1+(this.eg_level_>>t),this.eg_level_<=0&&this.ShiftPhase(s.EGPhase.decay)),this.EGUpdate()}else if(0===this.ssg_type_)this.eg_level_+=h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_&&this.ShiftPhase(this.eg_phase_+1),this.EGUpdate();else if(this.eg_level_+=4*h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_)switch(this.EGUpdate(),this.eg_phase_){case s.EGPhase.decay:this.ShiftPhase(s.EGPhase.sustain);break;case s.EGPhase.sustain:this.ShiftPhase(s.EGPhase.attack);break;case s.EGPhase.release:this.ShiftPhase(s.EGPhase.off)}this.eg_curve_count_++}EGStep(){this.eg_count_-=this.eg_count_diff_,this.eg_count_<=0&&this.EGCalc()}PGCalc(){var t=this.pg_count_;return this.pg_count_+=this.pg_diff_,t}PGCalcL(){var t=this.pg_count_;return this.pg_count_+=this.pg_diff_+(this.pg_diff_lfo_*this.chip_.GetPMV()>>5),t}Calc(t){if(this.eg_count_-=this.eg_count_diff_,this.eg_count_<=0){if(this.eg_count_=786048,this.eg_phase_===s.EGPhase.attack){var e=h.attacktable[this.eg_rate_][7&this.eg_curve_count_];e>=0&&(this.eg_level_-=1+(this.eg_level_>>e),this.eg_level_<=0&&this.ShiftPhase(s.EGPhase.decay))}else this.eg_level_+=h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_&&this.ShiftPhase(this.eg_phase_+1);var i=this.tl_out_+this.eg_level_;this.eg_out_=i<1023?i<<3:8184,this.eg_curve_count_++}this.out2_=this.out_;var _=this.pg_count_;this.pg_count_+=this.pg_diff_;var r=_>>19;r+=t>>19-(2+h.IS2EC_SHIFT);var a=this.eg_out_+h.sinetable[1023&r];return this.out_=a<8192?h.cltable[a]:0,this.out_}CalcL(t){if(this.eg_count_-=this.eg_count_diff_,this.eg_count_<=0){if(this.eg_count_=786048,this.eg_phase_===s.EGPhase.attack){var e=h.attacktable[this.eg_rate_][7&this.eg_curve_count_];e>=0&&(this.eg_level_-=1+(this.eg_level_>>e),this.eg_level_<=0&&this.ShiftPhase(s.EGPhase.decay))}else this.eg_level_+=h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_&&this.ShiftPhase(this.eg_phase_+1);var i=this.tl_out_+this.eg_level_;this.eg_out_=i<1023?i<<3:8184,this.eg_curve_count_++}var _=this.pg_count_;this.pg_count_+=this.pg_diff_+(this.pg_diff_lfo_*this.chip_.pmv_>>5);var r=_>>19;r+=t>>19-(2+h.IS2EC_SHIFT);var a=this.eg_out_+h.sinetable[1023&r]+this.ams_[this.chip_.aml_];return this.out_=a<8192?h.cltable[a]:0,this.out_}CalcN(t){this.EGStep();var e=Math.max(0,1023-(this.tl_out_+this.eg_level_))<<1;return t=(1&t)-1,this.out_=e+t^t,this.out_}CalcFB(t){if(this.eg_count_-=this.eg_count_diff_,this.eg_count_<=0){if(this.eg_count_=786048,this.eg_phase_===s.EGPhase.attack){var e=h.attacktable[this.eg_rate_][7&this.eg_curve_count_];e>=0&&(this.eg_level_-=1+(this.eg_level_>>e),this.eg_level_<=0&&this.ShiftPhase(s.EGPhase.decay))}else this.eg_level_+=h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_&&this.ShiftPhase(this.eg_phase_+1);var i=this.tl_out_+this.eg_level_;this.eg_out_=i<1023?i<<3:8184,this.eg_curve_count_++}var _=this.out_+this.out2_;this.out2_=this.out_;var r=this.pg_count_;this.pg_count_+=this.pg_diff_;var a=r>>19;t<31&&(a+=_<<1+h.IS2EC_SHIFT>>t>>19);var o=this.eg_out_+h.sinetable[1023&a];return this.out_=o<8192?h.cltable[o]:0,this.out2_}CalcFBL(t){if(this.eg_count_-=this.eg_count_diff_,this.eg_count_<=0){if(this.eg_count_=786048,this.eg_phase_===s.EGPhase.attack){var e=h.attacktable[this.eg_rate_][7&this.eg_curve_count_];e>=0&&(this.eg_level_-=1+(this.eg_level_>>e),this.eg_level_<=0&&this.ShiftPhase(s.EGPhase.decay))}else this.eg_level_+=h.decaytable1[this.eg_rate_][7&this.eg_curve_count_],this.eg_level_>=this.eg_level_on_next_phase_&&this.ShiftPhase(this.eg_phase_+1);var i=this.tl_out_+this.eg_level_;this.eg_out_=i<1023?i<<3:8184,this.eg_curve_count_++}var _=this.out_+this.out2_;this.out2_=this.out_;var r=this.pg_count_;this.pg_count_+=this.pg_diff_+(this.pg_diff_lfo_*this.chip_.pmv_>>5);var a=r>>19;t<31&&(a+=_<<1+h.IS2EC_SHIFT>>t>>19);var o=this.eg_out_+h.sinetable[1023&a]+this.ams_[this.chip_.aml_];return this.out_=o<8192?h.cltable[o]:0,this.out_}ResetFB(){this.out_=this.out2_=0}KeyOn(){this.keyon_||(this.keyon_=!0,this.eg_phase_!==s.EGPhase.off&&this.eg_phase_!==s.EGPhase.release||(this.ssg_phase_=-1,this.ShiftPhase(s.EGPhase.attack),this.EGUpdate(),this.in2_=this.out_=this.out2_=0,this.pg_count_=0))}KeyOff(){this.keyon_&&(this.keyon_=!1,this.ShiftPhase(s.EGPhase.release))}IsOn(){return this.eg_phase_!==s.EGPhase.off}SetDT(t){this.detune_=32*t,this.param_changed_=!0}SetDT2(t){this.detune2_=3&t,this.param_changed_=!0}SetMULTI(t){this.multiple_=t,this.param_changed_=!0}SetTL(t,e){e||(this.tl_=t,this.param_changed_=!0),this.tl_latch_=t}SetAR(t){this.ar_=t,this.param_changed_=!0}SetDR(t){this.dr_=t,this.param_changed_=!0}SetSR(t){this.sr_=t,this.param_changed_=!0}SetSL(t){this.sl_=t,this.param_changed_=!0}SetRR(t){this.rr_=t,this.param_changed_=!0}SetKS(t){this.ks_=t,this.param_changed_=!0}SetAMON(t){this.amon_=t,this.param_changed_=!0}Mute(t){this.mute_=t,this.param_changed_=!0}SetMS(t){this.ms_=t,this.param_changed_=!0}Out(){return this.out_}Refresh(){this.param_changed_=!0}}e.Operator=h,h.notetable=[0,0,0,0,0,0,0,1,2,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,9,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,14,15,15,15,15,15,15,15,16,16,16,16,16,16,16,17,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,22,23,23,23,23,23,23,23,24,24,24,24,24,24,24,25,26,27,27,27,27,27,27,27,28,28,28,28,28,28,28,29,30,31,31,31,31,31,31,31],h.dttable=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,2,2,2,2,2,4,4,4,4,4,6,6,6,8,8,8,10,10,12,12,14,16,16,16,16,2,2,2,2,4,4,4,4,4,6,6,6,8,8,8,10,10,12,12,14,16,16,18,20,22,24,26,28,32,32,32,32,4,4,4,4,4,6,6,6,8,8,8,10,10,12,12,14,16,16,18,20,22,24,26,28,32,34,38,40,44,44,44,44,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-2,-2,-2,-2,-2,-2,-2,-2,-4,-4,-4,-4,-4,-6,-6,-6,-8,-8,-8,-10,-10,-12,-12,-14,-16,-16,-16,-16,-2,-2,-2,-2,-4,-4,-4,-4,-4,-6,-6,-6,-8,-8,-8,-10,-10,-12,-12,-14,-16,-16,-18,-20,-22,-24,-26,-28,-32,-32,-32,-32,-4,-4,-4,-4,-4,-6,-6,-6,-8,-8,-8,-10,-10,-12,-12,-14,-16,-16,-18,-20,-22,-24,-26,-28,-32,-34,-38,-40,-44,-44,-44,-44],h.decaytable1=[[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,1,1,1,1,1],[1,1,1,0,1,1,1,0],[1,1,1,0,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,0,1,0,1,0,1,0],[1,1,1,0,1,0,1,0],[1,1,1,0,1,1,1,0],[1,1,1,1,1,1,1,0],[1,1,1,1,1,1,1,1],[2,1,1,1,2,1,1,1],[2,1,2,1,2,1,2,1],[2,2,2,1,2,2,2,1],[2,2,2,2,2,2,2,2],[4,2,2,2,4,2,2,2],[4,2,4,2,4,2,4,2],[4,4,4,2,4,4,4,2],[4,4,4,4,4,4,4,4],[8,4,4,4,8,4,4,4],[8,4,8,4,8,4,8,4],[8,8,8,4,8,8,8,4],[16,16,16,16,16,16,16,16],[16,16,16,16,16,16,16,16],[16,16,16,16,16,16,16,16],[16,16,16,16,16,16,16,16]],h.decaytable2=[1,2,4,8,16,32,64,128,256,512,1024,2047,2047,2047,2047,2047],h.attacktable=[[-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1],[4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4],[4,4,4,4,4,4,4,4],[4,4,4,-1,4,4,4,-1],[4,4,4,-1,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,-1,4,-1,4,-1,4,-1],[4,4,4,-1,4,-1,4,-1],[4,4,4,-1,4,4,4,-1],[4,4,4,4,4,4,4,-1],[4,4,4,4,4,4,4,4],[3,4,4,4,3,4,4,4],[3,4,3,4,3,4,3,4],[3,3,3,4,3,3,3,4],[3,3,3,3,3,3,3,3],[2,3,3,3,2,3,3,3],[2,3,2,3,2,3,2,3],[2,2,2,3,2,2,2,3],[2,2,2,2,2,2,2,2],[1,2,2,2,1,2,2,2],[1,2,1,2,1,2,1,2],[1,1,1,2,1,1,1,2],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0]],h.ssgenvtable=[[[[1,1],[1,1],[1,1]],[[0,1],[1,1],[1,1]]],[[[0,1],[2,0],[2,0]],[[0,1],[2,0],[2,0]]],[[[1,-1],[0,1],[1,-1]],[[0,1],[1,-1],[0,1]]],[[[1,-1],[0,0],[0,0]],[[0,1],[0,0],[0,0]]],[[[2,-1],[2,-1],[2,-1]],[[1,-1],[2,-1],[2,-1]]],[[[1,-1],[0,0],[0,0]],[[1,-1],[0,0],[0,0]]],[[[0,1],[1,-1],[0,1]],[[1,-1],[0,1],[1,-1]]],[[[0,1],[2,0],[2,0]],[[1,-1],[2,0],[2,0]]]],h.sinetable=(()=>{for(var t=[],e=Math.log(2),s=0;s<512;s++){var i=(2*s+1)*Math.PI/1024,h=-256*Math.log(Math.sin(i))/e,_=Math.floor(h+.5)+1;t[s]=2*_,t[512+s|0]=2*_+1}return t})(),h.cltable=(()=>{var t,e,s=[];for(t=0,e=0;t<256;t++){var i=Math.floor(Math.pow(2,13-t/256));i=i+2&-4,s[e++]=i,s[e++]=-i}for(t=e;e<8192;)s[e++]=s[t++-512]/2|0;return s})(),h.amtable=(()=>{for(var t,e,s=i.JaggArray.I3(2,8,256),h=[[31,6,4,3],[31,2,1,0]],_=0;_<2;_++)for(t=0;t<4;t++)for(e=0;e<256;e++)s[_][t][e]=2*(4*e>>h[_][t])<<2;return s})(),h.IS2EC_SHIFT=16}.apply(e,i))||(t.exports=h)},430:(t,e,s)=>{var i;void 0===(i=function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Timer=void 0,e.Timer=class{constructor(){this.regta=new Array(2)}Reset(){this.timera_count=0,this.timerb_count=0}Count(t){var e=!1;if(0!==this.timera_count&&(this.timera_count-=t<<16,this.timera_count<=0)){for(e=!0,this.TimerA();this.timera_count<=0;)this.timera_count+=this.timera;4&this.regtc&&this.SetStatus(1)}if(0!==this.timerb_count&&(this.timerb_count-=t<<12,this.timerb_count<=0)){for(e=!0;this.timerb_count<=0;)this.timerb_count+=this.timerb;8&this.regtc&&this.SetStatus(2)}return e}GetNextEvent(){var t=(this.timera_count+65535>>16)-1,e=(this.timerb_count+4095>>12)-1;return(t<e?t:e)+1}SetStatus(t){}ResetStatus(t){}SetTimerBase(t){this.timer_step=65536e6/t|0}SetTimerA(t,e){var s;this.regta[1&t]=0|e,s=(this.regta[0]<<2)+(3&this.regta[1]),this.timera=(1024-s)*this.timer_step}SetTimerB(t){this.timerb=(256-t)*this.timer_step}SetTimerControl(t){var e=this.regtc^t;this.regtc=0|t,16&t&&this.ResetStatus(1),32&t&&this.ResetStatus(2),1&e&&(this.timera_count=1&t?this.timera:0),2&e&&(this.timerb_count=2&t?this.timerb:0)}TimerA(){}}}.apply(e,[s,e]))||(t.exports=i)}},e={},function s(i){var h=e[i];if(void 0!==h)return h.exports;var _=e[i]={exports:{}};return t[i](_,_.exports,s),_.exports}(461);var t,e}));